{"ast":null,"code":"import _taggedTemplateLiteralLoose from\"@babel/runtime/helpers/taggedTemplateLiteralLoose\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";import _inherits from\"@babel/runtime/helpers/inherits\";function _templateObject5(){var data=_taggedTemplateLiteralLoose([\"\\n    width: 250;\\n    height: 60;\\n    backgroundColor: \",\";\\n    borderRadius: 40;\\n    justifyContent: center;\\n    alignItems: center;\\n\"]);_templateObject5=function _templateObject5(){return data;};return data;}function _templateObject4(){var data=_taggedTemplateLiteralLoose([\"\\n    width: 120;\\n    height: 130;\\n    backgroundColor: pink;\\n    borderRadius: 40;\\n    justifyContent: center;\\n    alignItems: center;\\n    marginTop : 10;\\n    marginRight : \",\";\\n\"]);_templateObject4=function _templateObject4(){return data;};return data;}function _templateObject3(){var data=_taggedTemplateLiteralLoose([\"\\n    fontSize: 25;\\n    color: #fff;\\n    textAlign: center;\\n    paddingLeft: 10;\\n    paddingRight: 10;\\n    marginTop: \",\";\\n    marginBottom : 30;\\n\"]);_templateObject3=function _templateObject3(){return data;};return data;}function _templateObject2(){var data=_taggedTemplateLiteralLoose([\"\\n    width: \",\";\\n    height: \",\";\\n    position:absolute;\\n    bottom:-20;\\n    backgroundColor: 'rgb(29,25,204)';\\n    borderRadius:\",\";;\\n    borderBottomEndRadius :  \",\";\\n    borderBottomStartRadius :  \",\";\\n    borderWidth: 0;\\n    justifyContent: flex-start;\\n    alignItems: center;\\n    paddingTop : 15;\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteralLoose([\"\\n    width: 250;\\n    height: 250;\\n    marginRight: 40;\\n    marginLeft: 40;\\n    marginTop: 10;\\n    paddingTop: 10;\\n    paddingBottom: 10;\\n    backgroundColor: #fff;\\n    borderRadius: 200;\\n    borderWidth: 10;\\n    borderColor: \",\";\\n    justifyContent: center;\\n    alignItems: center;\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React from\"react\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import Image from\"react-native-web/dist/exports/Image\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import Alert from\"react-native-web/dist/exports/Alert\";import StatusBar from\"react-native-web/dist/exports/StatusBar\";import Dimensions from\"react-native-web/dist/exports/Dimensions\";import moment from\"moment\";import\"moment/locale/th\";import styled from\"styled-components\";import{SettingApp}from\"../appConfig\";import AsyncStorage from\"react-native-web/dist/exports/AsyncStorage\";import axios from\"axios\";moment.locale(\"th\");var LinksScreen=function(_React$Component){_inherits(LinksScreen,_React$Component);function LinksScreen(){var _getPrototypeOf2;var _this;_classCallCheck(this,LinksScreen);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(LinksScreen)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={openMenu:false,time:moment().format(\"HH:mm\"),status:\"start\",BreakDown:false,User:\"\",WT_ID:0,latlng:{latitude:0,longitude:0}};_this.componentDidMount=function _callee(){var value;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"@User\"));case 3:value=_context.sent;if(!(value!==null)){_context.next=7;break;}_context.next=7;return _regeneratorRuntime.awrap(_this.setState({User:JSON.parse(value)}));case 7:_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 12:_this.fetchData();_this.intervalID=setInterval(function(){return _this.tick();},1000);_this.intervalID=setInterval(function(){return _this.onUpdateLocation();},5000);case 15:case\"end\":return _context.stop();}}},null,null,[[0,9]]);};_this.tick=function _callee2(){var value;return _regeneratorRuntime.async(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"@User\"));case 3:value=_context2.sent;if(!(value!==null)){_context2.next=7;break;}_context2.next=7;return _regeneratorRuntime.awrap(_this.setState({User:JSON.parse(value)}));case 7:_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 12:_this.setState({time:moment().format(\"HH:mm\")});case 13:case\"end\":return _context2.stop();}}},null,null,[[0,9]]);};_this.getLocation=function _callee3(){return _regeneratorRuntime.async(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:navigator.geolocation.getCurrentPosition(function(position){console.log('in');var latlng={latitude:parseFloat(JSON.stringify(position.coords.latitude)),longitude:parseFloat(JSON.stringify(position.coords.longitude))};_this.setState({latlng:latlng});},function(error){return alert(error.message);},{enableHighAccuracy:true,timeout:20000,maximumAge:1000});_context3.next=3;return _regeneratorRuntime.awrap(navigator.geolocation.watchPosition(function(position){var latlng={latitude:parseFloat(JSON.stringify(position.coords.latitude)),longitude:parseFloat(JSON.stringify(position.coords.longitude))};_this.setState({latlng:latlng});}));case 3:_this.watchID=_context3.sent;case 4:case\"end\":return _context3.stop();}}});};_this.onUpdateLocation=function _callee4(){var _this$state,User,latlng;return _regeneratorRuntime.async(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_this$state=_this.state,User=_this$state.User,latlng=_this$state.latlng;console.log(\"in ========\");_context4.next=4;return _regeneratorRuntime.awrap(_this.getLocation());case 4:axios({url:SettingApp+\"/UpdateLocation\",method:\"post\",data:{Vehicle_ID:\"\"+User.Vehicle_ID,lat:\"\"+latlng.latitude,lon:\"\"+latlng.longitude},headers:{Accept:\"application/json\",\"Content-Type\":\"application/json\"}}).then(function(response){console.log(response.status);if(response.status==200){console.log('updateLocation');}}).catch(function(error){console.log(error);});case 5:case\"end\":return _context4.stop();}}});};_this.fetchData=function _callee5(){var response,CheckWorkStatus,responseVehicle,VehicleData;return _regeneratorRuntime.async(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return _regeneratorRuntime.awrap(fetch(SettingApp+\"/CheckWorkStatus?user_id='\"+_this.state.User.user_id+\"'\"));case 2:response=_context5.sent;_context5.next=5;return _regeneratorRuntime.awrap(response.json());case 5:CheckWorkStatus=_context5.sent;_context5.next=8;return _regeneratorRuntime.awrap(fetch(SettingApp+\"/getVehicleQuery?Vehicle_ID='\"+CheckWorkStatus[0].Vehicle_ID+\"'\"));case 8:responseVehicle=_context5.sent;_context5.next=11;return _regeneratorRuntime.awrap(responseVehicle.json());case 11:VehicleData=_context5.sent;_this.setState({status:CheckWorkStatus[0].status==0?\"end\":\"start\",WT_ID:CheckWorkStatus[0].WT_ID,BreakDown:VehicleData[0].BreakDown_Status==1?true:false});case 13:case\"end\":return _context5.stop();}}});};_this.Working=function _callee6(){var _this$state2,status,User,WT_ID;return _regeneratorRuntime.async(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_this$state2=_this.state,status=_this$state2.status,User=_this$state2.User,WT_ID=_this$state2.WT_ID;if(!(status=='start')){_context6.next=6;break;}_context6.next=4;return _regeneratorRuntime.awrap(axios({url:SettingApp+\"/StartWorking\",method:\"post\",data:{Vehicle_ID:\"'\"+User.Vehicle_ID+\"'\",user_id:\"\"+User.user_id},headers:{Accept:\"application/json\",\"Content-Type\":\"application/json\"}}).then(function(response){console.log(response.status);if(response.status==200){Alert.alert(\"เปลี่ยนสถานะเริ่มงานเรียบร้อย\");}}).catch(function(error){console.log(error);}));case 4:_context6.next=8;break;case 6:_context6.next=8;return _regeneratorRuntime.awrap(axios({url:SettingApp+\"/EndWorking\",method:'post',data:{Vehicle_ID:\"'\"+User.Vehicle_ID+\"'\",WT_ID:\"'\"+WT_ID+\"'\"},headers:{Accept:'application/json','Content-Type':'application/json'}}).then(function(response){console.log(response.status);if(response.status==200){Alert.alert('เปลี่ยนสถานะจบการทำงานเรียบร้อย');}}).catch(function(error){console.log(error);}));case 8:_this.setState({status:_this.state.status==\"start\"?\"end\":\"start\"});_context6.next=11;return _regeneratorRuntime.awrap(_this.fetchData());case 11:case\"end\":return _context6.stop();}}});};_this.onBreakDown=function _callee7(){var navigation,_this$state3,BreakDown,User,WT_ID,status;return _regeneratorRuntime.async(function _callee7$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:navigation=_this.props.navigation;_this$state3=_this.state,BreakDown=_this$state3.BreakDown,User=_this$state3.User,WT_ID=_this$state3.WT_ID;status=0;Alert.alert(\"\\u0E01\\u0E23\\u0E38\\u0E13\\u0E32\\u0E22\\u0E37\\u0E19\\u0E22\\u0E31\\u0E19\",\"\\u0E04\\u0E38\\u0E13\\u0E15\\u0E49\\u0E2D\\u0E07\\u0E01\\u0E32\\u0E23\\u0E40\\u0E1B\\u0E25\\u0E35\\u0E48\\u0E22\\u0E19\\u0E2A\\u0E16\\u0E32\\u0E19\\u0E30\\u0E1E\\u0E32\\u0E2B\\u0E19\\u0E30 \\u0E43\\u0E0A\\u0E48\\u0E2B\\u0E23\\u0E37\\u0E2D\\u0E44\\u0E21\\u0E48?\",[{text:\"Cancel\",style:\"cancel\"},{text:\"OK\",onPress:function onPress(){return _regeneratorRuntime.async(function onPress$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:if(!(BreakDown==false)){_context9.next=6;break;}_context9.next=3;return _regeneratorRuntime.awrap(Alert.alert(\"\\u0E01\\u0E23\\u0E38\\u0E13\\u0E32\\u0E22\\u0E37\\u0E19\\u0E22\\u0E31\\u0E19\",\"\\u0E04\\u0E38\\u0E13\\u0E15\\u0E49\\u0E2D\\u0E07\\u0E01\\u0E32\\u0E23\\u0E40\\u0E1B\\u0E25\\u0E35\\u0E48\\u0E22\\u0E19\\u0E2A\\u0E16\\u0E32\\u0E19\\u0E30\\u0E1E\\u0E32\\u0E2B\\u0E19\\u0E30 \\u0E43\\u0E0A\\u0E48\\u0E2B\\u0E23\\u0E37\\u0E2D\\u0E44\\u0E21\\u0E48?\",[{text:\"ลางจูง\",onPress:function onPress(){return _regeneratorRuntime.async(function onPress$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:console.log('ลากจูง');_context7.next=3;return _regeneratorRuntime.awrap(axios({url:SettingApp+\"/StartBreakDown\",method:\"post\",data:{WT_ID:\"'\"+WT_ID+\"'\",Vehicle_ID:\"'\"+User.Vehicle_ID+\"'\",status:\"1\",user_id:\"'\"+User.user_id+\"'\"},headers:{Accept:\"application/json\",\"Content-Type\":\"application/json\"}}).then(function(response){console.log(response.status);if(response.status==200){Alert.alert('เปลี่ยนสถานะพาหนะเรียบร้อย');this.setState({BreakDown:!this.state.BreakDown});}}).catch(function(error){console.log(error);}));case 3:case\"end\":return _context7.stop();}}});}},{text:\"สามารถซ่อมได้\",onPress:function onPress(){return _regeneratorRuntime.async(function onPress$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:console.log('ซ่อมได้');_context8.next=3;return _regeneratorRuntime.awrap(axios({url:SettingApp+\"/StartBreakDown\",method:\"post\",data:{WT_ID:\"'\"+WT_ID+\"'\",Vehicle_ID:\"'\"+User.Vehicle_ID+\"'\",status:\"0\",user_id:\"'\"+User.user_id+\"'\"},headers:{Accept:\"application/json\",\"Content-Type\":\"application/json\"}}).then(function(response){console.log(response.status);if(response.status==200){Alert.alert('เปลี่ยนสถานะพาหนะเรียบร้อย');this.setState({BreakDown:!this.state.BreakDown});}}).catch(function(error){console.log(error);}));case 3:case\"end\":return _context8.stop();}}});}}],{cancelable:false}));case 3:console.log('breakdown!!!!');_context9.next=9;break;case 6:console.log('end');_context9.next=9;return _regeneratorRuntime.awrap(axios({url:SettingApp+\"/EndBreakDown\",method:'post',data:{Vehicle_ID:\"\"+User.Vehicle_ID},headers:{Accept:'application/json','Content-Type':'application/json'}}).then(function(response){console.log(response.status);if(response.status==200){Alert.alert('เปลี่ยนสถานะพาหนะเรียบร้อย');this.setState({BreakDown:!this.state.BreakDown});}}).catch(function(error){console.log(error);}));case 9:_this.setState({BreakDown:!_this.state.BreakDown});case 10:case\"end\":return _context9.stop();}}});}}],{cancelable:false});console.log(\"BreakDown ::: \",_this.state.BreakDown);case 5:case\"end\":return _context10.stop();}}});};_this.onLogOut=function(){var navigation=_this.props.navigation;Alert.alert(\"\\u0E01\\u0E23\\u0E38\\u0E13\\u0E32\\u0E22\\u0E37\\u0E19\\u0E22\\u0E31\\u0E19\",\"\\u0E04\\u0E38\\u0E13\\u0E15\\u0E49\\u0E2D\\u0E07\\u0E01\\u0E32\\u0E23\\u0E2D\\u0E2D\\u0E01\\u0E08\\u0E32\\u0E01\\u0E23\\u0E30\\u0E1A\\u0E1A\\u0E43\\u0E0A\\u0E48\\u0E2B\\u0E23\\u0E37\\u0E2D\\u0E44\\u0E21\\u0E48?\",[{text:\"Cancel\",style:\"cancel\"},{text:\"OK\",onPress:function onPress(){AsyncStorage.clear();navigation.navigate(\"Home\");}}],{cancelable:false});};return _this;}_createClass(LinksScreen,[{key:\"componentWillUnmount\",value:function componentWillUnmount(){clearInterval(this.intervalID);}},{key:\"render\",value:function render(){var _this2=this;var navigation=this.props.navigation;var User=this.state.User;return React.createElement(View,{style:styles.container},React.createElement(StatusBar,{barStyle:\"dark-content\"}),React.createElement(Text,{style:styles.showDate},moment().format(\"วันdddd D MMMM \"),\" \",parseInt(moment().format(\"YYYY\"))+543),React.createElement(Text,{style:styles.showVehicle},\"\\u0E1E\\u0E32\\u0E2B\\u0E19\\u0E30\\u0E17\\u0E35\\u0E48\\u0E43\\u0E0A\\u0E49 \",User.Vehicle_Name,\"\\n\",\"\\u0E1B\\u0E23\\u0E30\\u0E40\\u0E20\\u0E17 \",User.Vehicle_Type),React.createElement(WorkingButton,{status:this.state.status,underlayColor:\"#fff\",onPress:function onPress(){return _this2.Working();}},React.createElement(Text,{style:styles.WorkingBT},this.state.status==\"start\"?\"เข้างาน\":\"ออกงาน\")),React.createElement(Text,{style:styles.showCompany},User.Company),React.createElement(Text,{style:styles.showTime},this.state.time),React.createElement(BreakdownButton,{onPress:function onPress(){return _this2.onBreakDown();},BreakDown:this.state.BreakDown},React.createElement(Text,{style:styles.BreakdownText},\"\\u0E1E\\u0E32\\u0E2B\\u0E19\\u0E30\\u0E40\\u0E2A\\u0E35\\u0E22\")),React.createElement(MenuSlide,{openMenu:this.state.openMenu,onPress:function onPress(){return _this2.setState({openMenu:!_this2.state.openMenu});}},React.createElement(TextMenuSlide,{openMenu:this.state.openMenu},User.Firstname,\" \",User.Lastname),this.state.openMenu&&React.createElement(React.Fragment,null,React.createElement(View,{style:styles.Line}),React.createElement(View,{style:styles.ViewFlex},React.createElement(HistoryBTScreen,{margin:\"20\",onPress:function onPress(){return navigation.navigate(\"History\");}},React.createElement(Text,{style:styles.HistoryBT},\"\\u0E1B\\u0E23\\u0E30\\u0E27\\u0E31\\u0E15\\u0E34\")),React.createElement(HistoryBTScreen,{onPress:function onPress(){return navigation.navigate(\"Profile\");}},React.createElement(Text,{style:styles.HistoryBT},\"\\u0E02\\u0E49\\u0E2D\\u0E21\\u0E39\\u0E25\\u0E2A\\u0E48\\u0E27\\u0E19\\u0E15\\u0E31\\u0E27\"))),React.createElement(View,{style:styles.ViewFlex},React.createElement(HistoryBTScreen,{onPress:function onPress(){return _this2.onLogOut();}},React.createElement(Text,{style:styles.HistoryBT},\"\\u0E2D\\u0E2D\\u0E01\\u0E08\\u0E32\\u0E01\\u0E23\\u0E30\\u0E1A\\u0E1A\"))))));}}]);return LinksScreen;}(React.Component);LinksScreen.navigationOptions={header:null,gesturesEnabled:false};export{LinksScreen as default};var width=Dimensions.get(\"window\").width;var styles=StyleSheet.create({container:{flex:3,justifyContent:\"space-around\",alignItems:\"center\",paddingTop:50,paddingBottom:150},showDate:{fontSize:25,color:\"grey\"},showCompany:{fontSize:20,color:\"grey\"},showVehicle:{fontSize:20,color:\"grey\",textAlign:\"center\"},showTime:{fontSize:70,color:\"rgb(29, 25, 204)\"},WorkingBT:{fontSize:50,color:\"rgb(29, 25, 204)\",textAlign:\"center\",paddingLeft:10,paddingRight:10,fontWeight:\"900\"},Line:{width:40,height:3,backgroundColor:\"rgb(71, 69, 245)\",top:0,position:\"absolute\",borderRadius:50,marginTop:10},HistoryBT:{fontSize:20,color:\"rgb(29, 25, 204)\",textAlign:\"center\"},ViewFlex:{alignItems:\"center\",flexDirection:\"row\"},BreakdownText:{fontSize:25,color:\"#fff\"}});var WorkingButton=styled(TouchableOpacity)(_templateObject(),function(props){return props.status=='start'?'pink':'rgb(29,25,204)';});var MenuSlide=styled(TouchableOpacity)(_templateObject2(),width,function(props){return props.openMenu?450:120;},function(props){return props.openMenu?60:200;},function(props){return props.openMenu?0:200;},function(props){return props.openMenu?0:200;});var TextMenuSlide=styled(Text)(_templateObject3(),function(props){return props.openMenu?30:20;});var HistoryBTScreen=styled(TouchableOpacity)(_templateObject4(),function(props){return props.margin||0;});var BreakdownButton=styled(TouchableOpacity)(_templateObject5(),function(props){return props.BreakDown?'#cc0e0e':'#c7c7c7';});","map":{"version":3,"sources":["/Users/thanutpond/Desktop/whereApp/screens/WorkTime.js"],"names":["React","moment","styled","SettingApp","axios","locale","LinksScreen","state","openMenu","time","format","status","BreakDown","User","WT_ID","latlng","latitude","longitude","componentDidMount","AsyncStorage","getItem","value","setState","JSON","parse","console","log","fetchData","intervalID","setInterval","tick","onUpdateLocation","getLocation","navigator","geolocation","getCurrentPosition","position","parseFloat","stringify","coords","error","alert","message","enableHighAccuracy","timeout","maximumAge","watchPosition","watchID","url","method","data","Vehicle_ID","lat","lon","headers","Accept","then","response","catch","fetch","user_id","json","CheckWorkStatus","responseVehicle","VehicleData","BreakDown_Status","Working","Alert","onBreakDown","navigation","props","text","style","onPress","cancelable","onLogOut","clear","navigate","clearInterval","styles","container","showDate","parseInt","showVehicle","Vehicle_Name","Vehicle_Type","WorkingBT","showCompany","Company","showTime","BreakdownText","Firstname","Lastname","Line","ViewFlex","HistoryBT","Component","navigationOptions","header","gesturesEnabled","width","Dimensions","get","StyleSheet","create","flex","justifyContent","alignItems","paddingTop","paddingBottom","fontSize","color","textAlign","paddingLeft","paddingRight","fontWeight","height","backgroundColor","top","borderRadius","marginTop","flexDirection","WorkingButton","TouchableOpacity","MenuSlide","TextMenuSlide","Text","HistoryBTScreen","margin","BreakdownButton"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport {\n  StyleSheet,\n  View,\n  Text,\n  Image,\n  TouchableOpacity,\n  Alert,\n  StatusBar,\n  Dimensions\n} from \"react-native\";\nimport moment from \"moment\";\nimport \"moment/locale/th\"; // without this line it didn't work\nimport styled from \"styled-components\";\nimport { SettingApp } from \"../appConfig\";\nimport { AsyncStorage } from \"react-native\";\nimport axios from \"axios\";\n\nmoment.locale(\"th\");\n\nexport default class LinksScreen extends React.Component {\n  static navigationOptions = {\n    header: null,\n    gesturesEnabled: false,\n  };\n\n  state = {\n    openMenu: false, // เปิด menu\n    time: moment().format(\"HH:mm\"), // เก็บค่าเวลา ณ ปัจจุบัน\n    status: \"start\", // สถานะการทำงาน\n    BreakDown: false, // สถานะพาหนะ\n    User: \"\", // ค่า User\n    WT_ID : 0, // ค่า ID ของ Worktime ใน Database\n    latlng: { // ตำแหน่งสำหรับ Update ใน Database\n        latitude: 0,\n        longitude: 0\n      },\n  };\n\n\n  componentDidMount = async () => {\n    try { // นำค่าใน Localstorage มาเก็บไว้\n      const value = await AsyncStorage.getItem(\"@User\");\n      if (value !== null) {\n        await this.setState({ User: JSON.parse(value) });\n      }\n    } catch (error) {\n      console.log(error);\n    }\n\n    this.fetchData();\n    // เรียกใช้งานทุก 1 วิ\n    this.intervalID = setInterval(() => this.tick(), 1000);\n    // เรียกใช้งานทุก 5 วิ\n    this.intervalID = setInterval(() => this.onUpdateLocation(), 5000);\n  };\n\n  componentWillUnmount() {\n    clearInterval(this.intervalID);\n  }\n\n  \n  tick = async () => {\n    // ดึงข้อมูลจาก localStorage\n    try {\n      const value = await AsyncStorage.getItem(\"@User\");\n      if (value !== null) {\n        await this.setState({ User: JSON.parse(value) });\n      }\n    } catch (error) {\n      console.log(error);\n    }\n    // เปลี่ยนเวลาเป็นเวลาปัจจุบัน\n    this.setState({\n      time: moment().format(\"HH:mm\")\n    });\n  };\n\n\n  // ดึงข้อมูลตำแหน่งปัจจุบันของ User Code เป็น Pattle ของ getLocation\n  getLocation = async () => {\n    navigator.geolocation.getCurrentPosition(\n      position => {\n          console.log('in')\n        let latlng = {\n          latitude: parseFloat(JSON.stringify(position.coords.latitude)),\n          longitude: parseFloat(JSON.stringify(position.coords.longitude))\n        }\n        this.setState({ latlng })\n      },\n      error => alert(error.message),\n      { enableHighAccuracy: true, timeout: 20000, maximumAge: 1000 }\n    )\n    this.watchID = await navigator.geolocation.watchPosition(position => {\n      let latlng = {\n        latitude: parseFloat(JSON.stringify(position.coords.latitude)),\n        longitude: parseFloat(JSON.stringify(position.coords.longitude))\n      }\n      this.setState({ latlng })\n    })\n  }\n\n  /// อัพเดทตำแหน่งใน Database\n  onUpdateLocation = async() => {\n    let {User, latlng} = this.state\n    console.log(\"in ========\")\n    await this.getLocation()\n    // ส่งข้อมูลตำแหน่งไปยัง Database\n    axios({\n        url: `${SettingApp}/UpdateLocation`,\n        method: \"post\",\n        data: {\n          Vehicle_ID: `${User.Vehicle_ID}`,\n          lat: `${latlng.latitude}`,\n          lon: `${latlng.longitude}`\n        },\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\"\n        }\n      })\n        .then(function(response) {\n            console.log(response.status);\n            if (response.status == 200) {\n                console.log('updateLocation')\n            }\n        })\n        .catch(function(error) {\n          console.log(error);\n    });\n  }\n\n\n  fetchData = async () => {\n    // ดึงข้อมูลสถานะจาก Database\n    const response = await fetch(\n      `${SettingApp}/CheckWorkStatus?user_id='${this.state.User.user_id}'`\n    ); \n    const CheckWorkStatus = await response.json();\n\n    // ดึงข้อมูลรถที่ใช้อยู่ปัจจุบันจาก Database\n    const responseVehicle = await fetch(`${SettingApp}/getVehicleQuery?Vehicle_ID='${CheckWorkStatus[0].Vehicle_ID}'`); \n    const VehicleData = await responseVehicle.json();\n\n    // เก็บค่า\n    this.setState({ \n      // status ถ้าเป็น 0 = ทำงานอยู่ , 1 = จบงานแล้วเตรียมเริ่มงานใหม่\n      status: CheckWorkStatus[0].status == 0 ? \"end\" : \"start\", \n      // ดึงค่า ID ของ worktime ล่าสุด\n      WT_ID :  CheckWorkStatus[0].WT_ID,\n      // status พาหนะรถ ถ้าเป็น 0 = ปกติ , 1 = รถเสีย\n      BreakDown : VehicleData[0].BreakDown_Status == 1 ? true : false \n    });\n  };\n\n  // ปุ่มทำงาน\n  Working = async() => {\n    let { status, User, WT_ID } = this.state;\n    // เช็คสถานะของ Status การทำงาน \n    if (status == 'start') {\n      // ถ้าเป็น Start ให้กดเพื่อเริ่มทำงาน ส่งค่าไปยัง APi StartWorking โดยส่ง  Vehicle_ID พาหนะที่ใช้ และ user_id\n      await axios({\n        url: `${SettingApp}/StartWorking`,\n        method: \"post\",\n        data: {\n          Vehicle_ID: `'${User.Vehicle_ID}'`,\n          user_id: `${User.user_id}`\n        },\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\"\n        }\n      })\n        .then(function(response) {\n          console.log(response.status);\n          if (response.status == 200) {      \n            Alert.alert(\"เปลี่ยนสถานะเริ่มงานเรียบร้อย\")\n        }\n        })\n        .catch(function(error) {\n          console.log(error);\n        });\n    } else {\n      // ถ้าเป็น End ให้กดเพื่อจบการทำงาน ส่งค่าไปยัง APi EndWorking โดยส่ง  Vehicle_ID พาหนะที่ใช้ และ WT_ID\n        await axios({\n            url: `${SettingApp}/EndWorking`,\n            method: 'post',\n            data: {\n              Vehicle_ID: `'${User.Vehicle_ID}'`,\n              WT_ID: `'${WT_ID}'`,\n            },\n            headers: {\n              Accept: 'application/json',\n              'Content-Type': 'application/json',\n            }\n          })\n            .then(function (response) {\n              console.log(response.status);\n                if (response.status == 200) {\n                    Alert.alert('เปลี่ยนสถานะจบการทำงานเรียบร้อย')\n                }\n            })\n            .catch(function (error) {\n              console.log(error);\n            })\n    }\n    this.setState({ status: this.state.status == \"start\" ? \"end\" : \"start\" });\n    await this.fetchData() \n  };\n\n  //เปลี่ยนสถานะพาหนะ ปกติ / เสีย\n  onBreakDown = async() => {\n    const { navigation } = this.props;\n    let { BreakDown, User, WT_ID } = this.state;\n    let status = 0;\n    Alert.alert(\n      `กรุณายืนยัน`,\n      `คุณต้องการเปลี่ยนสถานะพาหนะ ใช่หรือไม่?`,\n      [\n        {\n          text: \"Cancel\",\n          style: \"cancel\"\n        },\n        {\n          text: \"OK\",\n          onPress: async() => {\n              // this.setState({ BreakDown: !this.state.BreakDown })\n            // ถ้าสถานะ BreakDown == false ให้กดเพื่อเปลี่ยนเป็นพาหนะเสีย\n            if (BreakDown == false) {\n              await Alert.alert(\n                `กรุณายืนยัน`,\n                `คุณต้องการเปลี่ยนสถานะพาหนะ ใช่หรือไม่?`,\n                [\n                  {\n                    text: \"ลางจูง\",\n                    onPress: async() => {\n                      console.log('ลากจูง')\n                      await axios({\n                        url: `${SettingApp}/StartBreakDown`,\n                        method: \"post\",\n                        data: {\n                          WT_ID: `'${WT_ID}'`,\n                          Vehicle_ID: `'${User.Vehicle_ID}'`,\n                          status: `1`,\n                          user_id: `'${User.user_id}'`\n                        },\n                        headers: {\n                          Accept: \"application/json\",\n                          \"Content-Type\": \"application/json\"\n                        }\n                      })\n                        .then(function(response) {\n                          console.log(response.status);\n                            if (response.status == 200){ \n                              Alert.alert('เปลี่ยนสถานะพาหนะเรียบร้อย')\n                              this.setState({ BreakDown: !this.state.BreakDown});\n                            }\n                        })\n                        .catch(function(error) {\n                          console.log(error);\n                        });\n                    }\n                  },\n                  {\n                    text: \"สามารถซ่อมได้\",\n                    onPress: async() => {\n                      console.log('ซ่อมได้')\n                      await axios({\n                        url: `${SettingApp}/StartBreakDown`,\n                        method: \"post\",\n                        data: {\n                          WT_ID: `'${WT_ID}'`,\n                          Vehicle_ID: `'${User.Vehicle_ID}'`,\n                          status: `0`,\n                          user_id: `'${User.user_id}'`\n                        },\n                        headers: {\n                          Accept: \"application/json\",\n                          \"Content-Type\": \"application/json\"\n                        }\n                      })\n                        .then(function(response) {\n                          console.log(response.status);\n                            if (response.status == 200){ \n                              Alert.alert('เปลี่ยนสถานะพาหนะเรียบร้อย')\n                              this.setState({ BreakDown: !this.state.BreakDown});\n                            }\n                        })\n                        .catch(function(error) {\n                          console.log(error);\n                        });\n                    }\n                  }\n                ],\n                { cancelable: false }\n                );\n              console.log('breakdown!!!!')\n            } \n            else {\n              // ถ้าสถานะ BreakDown == true ให้กดเพื่อเปลี่ยนเป็นพาหนะปกติ\n              console.log('end')\n              await axios({\n                  url: `${SettingApp}/EndBreakDown`,\n                  method: 'post',\n                  data: {\n                    Vehicle_ID: `${User.Vehicle_ID}`,\n                    // WT_ID: `'7'`,\n                  },\n                  headers: {\n                    Accept: 'application/json',\n                    'Content-Type': 'application/json',\n                  }\n                })\n                  .then(function (response) {\n                    console.log(response.status);\n                    if (response.status == 200){ \n                      Alert.alert('เปลี่ยนสถานะพาหนะเรียบร้อย')\n                      this.setState({ BreakDown: !this.state.BreakDown});\n                    }\n                  })\n                  .catch(function (error) {\n                    console.log(error);\n                  })\n                }\n                  // Alert.alert('เปลี่ยนสถานะพาหนะเรียบร้อย')\n                  this.setState({ BreakDown: !this.state.BreakDown});\n              }\n            }\n          ],\n          { cancelable: false }\n          );\n          // await this.fetchData()\n          console.log(\"BreakDown ::: \",this.state.BreakDown)\n  };\n\n  \n  onLogOut = () => {\n    const { navigation } = this.props;\n    Alert.alert(\n      `กรุณายืนยัน`,\n      `คุณต้องการออกจากระบบใช่หรือไม่?`,\n      [\n        {\n          text: \"Cancel\",\n          style: \"cancel\"\n        },\n        {\n          text: \"OK\",\n          onPress: () => {\n            AsyncStorage.clear(); //ลบค่าใน Localstorage\n            navigation.navigate(\"Home\"); //เปลี่ยนไปหน้า Home\n          }\n        }\n      ],\n      { cancelable: false }\n    );\n  };\n\n  render() {\n    const { navigation } = this.props;\n    const { User } = this.state;\n    return (\n      <View style={styles.container}>\n        <StatusBar barStyle=\"dark-content\" />\n        <Text style={styles.showDate}>\n          {moment().format(\"วันdddd D MMMM \")}{\" \"}\n          {parseInt(moment().format(\"YYYY\")) + 543}\n        </Text>\n        <Text style={styles.showVehicle}>\n          พาหนะที่ใช้ {User.Vehicle_Name}\n          {\"\\n\"}\n          ประเภท {User.Vehicle_Type}\n        </Text>\n        <WorkingButton\n          status={this.state.status}\n          underlayColor=\"#fff\"\n          onPress={() => this.Working()}\n        >\n          <Text style={styles.WorkingBT}>\n            \n            {this.state.status == \"start\" ? \"เข้างาน\" : \"ออกงาน\"}\n          </Text>\n        </WorkingButton>\n\n        <Text style={styles.showCompany}>{User.Company}</Text>\n        <Text style={styles.showTime}>\n          {/* {moment().format('HH:mm')} */}\n          {this.state.time}\n        </Text>\n        <BreakdownButton\n          onPress={() => this.onBreakDown()}\n          BreakDown={this.state.BreakDown}\n        >\n          <Text style={styles.BreakdownText}>พาหนะเสีย</Text>\n        </BreakdownButton>\n        <MenuSlide\n          openMenu={this.state.openMenu}\n          onPress={() => this.setState({ openMenu: !this.state.openMenu })}\n        >\n          <TextMenuSlide openMenu={this.state.openMenu}>\n            {User.Firstname} {User.Lastname}\n          </TextMenuSlide>\n          {this.state.openMenu && (\n            <>\n              <View style={styles.Line} />\n              <View style={styles.ViewFlex}>\n                <HistoryBTScreen\n                  margin=\"20\"\n                  onPress={() => navigation.navigate(\"History\")}\n                >\n                  <Text style={styles.HistoryBT}>ประวัติ</Text>\n                </HistoryBTScreen>\n                <HistoryBTScreen onPress={() => navigation.navigate(\"Profile\")}>\n                  <Text style={styles.HistoryBT}>ข้อมูลส่วนตัว</Text>\n                </HistoryBTScreen>\n              </View>\n\n              <View style={styles.ViewFlex}>\n                {/* <HistoryBTScreen\n                  margin=\"20\"\n                  onPress={() => navigation.navigate(\"Vehicle\")}\n                >\n                  <Text style={styles.HistoryBT}>พาหนะ</Text>\n                </HistoryBTScreen> */}\n                <HistoryBTScreen onPress={() => this.onLogOut()}>\n                  <Text style={styles.HistoryBT}>ออกจากระบบ</Text>\n                </HistoryBTScreen>\n              </View>\n            </>\n          )}\n        </MenuSlide>\n      </View>\n    );\n  }\n}\n\nlet width = Dimensions.get(\"window\").width;\nconst styles = StyleSheet.create({\n  container: {\n    flex: 3,\n    justifyContent: \"space-around\",\n    alignItems: \"center\",\n    paddingTop: 50,\n    paddingBottom: 150\n  },\n  showDate: {\n    fontSize: 25,\n    color: \"grey\"\n  },\n  showCompany: {\n    fontSize: 20,\n    color: \"grey\"\n  },\n  showVehicle: {\n    fontSize: 20,\n    color: \"grey\",\n    textAlign: \"center\"\n  },\n  showTime: {\n    fontSize: 70,\n    color: \"rgb(29, 25, 204)\"\n  },\n  WorkingBT: {\n    fontSize: 50,\n    color: \"rgb(29, 25, 204)\",\n    textAlign: \"center\",\n    paddingLeft: 10,\n    paddingRight: 10,\n    fontWeight: \"900\"\n  },\n  Line: {\n    width: 40,\n    height: 3,\n    backgroundColor: \"rgb(71, 69, 245)\",\n    top: 0,\n    position: \"absolute\",\n    borderRadius: 50,\n    marginTop: 10\n  },\n  HistoryBT: {\n    fontSize: 20,\n    color: \"rgb(29, 25, 204)\",\n    textAlign: \"center\"\n  },\n  ViewFlex: {\n    alignItems: \"center\",\n    flexDirection: \"row\"\n  },\n  BreakdownText: {\n    fontSize: 25,\n    color: \"#fff\"\n  }\n});\n\nconst WorkingButton = styled(TouchableOpacity)`\n    width: 250;\n    height: 250;\n    marginRight: 40;\n    marginLeft: 40;\n    marginTop: 10;\n    paddingTop: 10;\n    paddingBottom: 10;\n    backgroundColor: #fff;\n    borderRadius: 200;\n    borderWidth: 10;\n    borderColor: ${props => props.status == 'start' ? 'pink' : 'rgb(29,25,204)'};\n    justifyContent: center;\n    alignItems: center;\n`\n\n\nconst MenuSlide = styled(TouchableOpacity)`\n    width: ${width};\n    height: ${props => props.openMenu ? 450 : 120};\n    position:absolute;\n    bottom:-20;\n    backgroundColor: 'rgb(29,25,204)';\n    borderRadius:${props => props.openMenu ? 60 : 200};;\n    borderBottomEndRadius :  ${props => props.openMenu ? 0 : 200};\n    borderBottomStartRadius :  ${props => props.openMenu ? 0 : 200};\n    borderWidth: 0;\n    justifyContent: flex-start;\n    alignItems: center;\n    paddingTop : 15;\n`;\n\nconst TextMenuSlide = styled(Text)`\n    fontSize: 25;\n    color: #fff;\n    textAlign: center;\n    paddingLeft: 10;\n    paddingRight: 10;\n    marginTop: ${props => props.openMenu ? 30 : 20};\n    marginBottom : 30;\n`\nconst HistoryBTScreen = styled(TouchableOpacity)`\n    width: 120;\n    height: 130;\n    backgroundColor: pink;\n    borderRadius: 40;\n    justifyContent: center;\n    alignItems: center;\n    marginTop : 10;\n    marginRight : ${props => props.margin || 0};\n`;\n\nconst BreakdownButton = styled(TouchableOpacity)`\n    width: 250;\n    height: 60;\n    backgroundColor: ${props => props.BreakDown ? '#cc0e0e' : '#c7c7c7'};\n    borderRadius: 40;\n    justifyContent: center;\n    alignItems: center;\n`;"]},"metadata":{},"sourceType":"module"}