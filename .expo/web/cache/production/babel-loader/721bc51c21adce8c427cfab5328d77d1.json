{"ast":null,"code":"import _taggedTemplateLiteralLoose from\"@babel/runtime/helpers/taggedTemplateLiteralLoose\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";import _inherits from\"@babel/runtime/helpers/inherits\";function _templateObject3(){var data=_taggedTemplateLiteralLoose([\"\\n  fontSize: 30;\\n  color: 'rgb(101,102,251)';\\n  textAlign: center;\\n  paddingLeft: 10;\\n  paddingRight: 10;\\n  marginTop: 10;\\n\"]);_templateObject3=function _templateObject3(){return data;};return data;}function _templateObject2(){var data=_taggedTemplateLiteralLoose([\"\\n  width: \",\";\\n  height: 90;\\n  backgroundColor: white;\\n  borderRadius: 60;\\n  borderBottomEndRadius :  0;\\n  borderBottomStartRadius :  0;\\n  borderWidth: 0;\\n  justifyContent: center;\\n  alignItems: center;\\n  marginTop : \",\";\\n  marginBottom : \",\"\\n  flexDirection: row;\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteralLoose([\"\\n  width: \",\";\\n  height: \",\";\\n  position:absolute;\\n  top:\",\";   \\n  backgroundColor: 'rgb(29,25,204)';\\n  borderRadius: 60;\\n  borderBottomEndRadius :  0;\\n  borderBottomStartRadius :  0;\\n  borderWidth: 0;\\n  justifyContent: flex-start;\\n  alignItems: center;\\n  paddingTop : 15;\\n  paddingBottom : 50;\\n\"]);_templateObject=function _templateObject(){return data;};return data;}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import React from\"react\";Dimensions;import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Image from\"react-native-web/dist/exports/Image\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import Dimensions from\"react-native-web/dist/exports/Dimensions\";import StatusBar from\"react-native-web/dist/exports/StatusBar\";import TextInput from\"react-native-web/dist/exports/TextInput\";import Keyboard from\"react-native-web/dist/exports/Keyboard\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import MapView,{PROVIDER_GOOGLE}from\"react-native-maps\";import{Marker}from\"react-native-maps\";import BusStopIcon from\"../components/BusStop\";import BusActive from\"../components/BusActive\";import VanBreakDown from\"../components/VanBreakDown\";import BoatBreakDown from\"../components/BoatBreakDown\";import TruckBreakDown from\"../components/TruckBreakDown\";import BusBreakDown from\"../components/BusBreakDown\";import TruckActive from\"../components/TruckActive\";import VanActive from\"../components/VanActive\";import BoatActive from\"../components/BoatActive\";import BusStopDetail from\"../components/BusStopDetail\";import styled from\"styled-components\";import{SettingApp}from\"../appConfig\";import AsyncStorage from\"react-native-web/dist/exports/AsyncStorage\";import moment from\"moment\";import\"moment/locale/th\";moment.locale(\"th\");var App=function(_React$Component){_inherits(App,_React$Component);function App(){var _getPrototypeOf2;var _this;_classCallCheck(this,App);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(App)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={typing:false,searchTxt:\"\",openMenu:false,markers:[{title:\"Your Location\",description:\"คุณอยู่ที่นี่\"}],open:false,User:'',region:{latitude:0,longitude:0,latitudeDelta:0.015,longitudeDelta:0.0121},tempRegion:{},latlng:{latitude:0,longitude:0},busStop:[],busLine:[],BusActive:[]};_this.componentDidMount=function _callee(){var value;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"@User\"));case 3:value=_context.sent;if(!(value!==null)){_context.next=7;break;}_context.next=7;return _regeneratorRuntime.awrap(_this.setState({User:JSON.parse(value)}));case 7:_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 12:_context.next=14;return _regeneratorRuntime.awrap(_this.getLocation());case 14:_context.next=16;return _regeneratorRuntime.awrap(_this.fetchData());case 16:_context.next=18;return _regeneratorRuntime.awrap(_this.fetchbusLineData());case 18:_context.next=20;return _regeneratorRuntime.awrap(_this.fetchbusActiveData());case 20:_this.intervalID=setInterval(function(){return _this.RefreshMaps();},5000);case 21:case\"end\":return _context.stop();}}},null,null,[[0,9]]);};_this.RefreshMaps=function _callee2(){var value;return _regeneratorRuntime.async(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"@region\"));case 3:value=_context2.sent;if(!(value!==null)){_context2.next=7;break;}_context2.next=7;return _regeneratorRuntime.awrap(_this.setState({region:JSON.parse(value)}));case 7:_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 12:_context2.next=14;return _regeneratorRuntime.awrap(_this.fetchbusActiveData());case 14:case\"end\":return _context2.stop();}}},null,null,[[0,9]]);};_this.fetchData=function _callee3(){var searchTxt,response,busStop,_response,tempBusStop,_busStop;return _regeneratorRuntime.async(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:searchTxt=_this.state.searchTxt;if(!(searchTxt==\"\")){_context3.next=12;break;}_context3.next=4;return _regeneratorRuntime.awrap(fetch(SettingApp+\"/busStop?searchText=\"+_this.state.searchTxt));case 4:response=_context3.sent;_context3.next=7;return _regeneratorRuntime.awrap(response.json());case 7:busStop=_context3.sent;_context3.next=10;return _regeneratorRuntime.awrap(_this.setState({busStop:busStop}));case 10:_context3.next=21;break;case 12:_context3.next=14;return _regeneratorRuntime.awrap(fetch(SettingApp+\"/SearchBusStop?searchText=\"+_this.state.searchTxt));case 14:_response=_context3.sent;_context3.next=17;return _regeneratorRuntime.awrap(_response.json());case 17:tempBusStop=_context3.sent;_busStop=tempBusStop[1];_context3.next=21;return _regeneratorRuntime.awrap(_this.setState({busStop:_busStop}));case 21:case\"end\":return _context3.stop();}}});};_this.fetchbusLineData=function _callee4(){var searchTxt,response,busLine,BuslineTemp,_response2,_busLine,busLine2,_BuslineTemp;return _regeneratorRuntime.async(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:searchTxt=_this.state.searchTxt;if(!(searchTxt==\"\")){_context4.next=14;break;}_context4.next=4;return _regeneratorRuntime.awrap(fetch(SettingApp+\"/busLine?searchText=\"+_this.state.searchTxt));case 4:response=_context4.sent;_context4.next=7;return _regeneratorRuntime.awrap(response.json());case 7:busLine=_context4.sent;BuslineTemp=[];busLine.map(function(e){BuslineTemp.push({data:e,show:false});});_context4.next=12;return _regeneratorRuntime.awrap(_this.setState({busLine:BuslineTemp}));case 12:_context4.next=25;break;case 14:_context4.next=16;return _regeneratorRuntime.awrap(fetch(SettingApp+\"/SearchBusStop?searchText=\"+_this.state.searchTxt));case 16:_response2=_context4.sent;_context4.next=19;return _regeneratorRuntime.awrap(_response2.json());case 19:_busLine=_context4.sent;busLine2=_busLine[0];_BuslineTemp=[];busLine2.map(function(e,key){_BuslineTemp.push({data:e,show:false});});_context4.next=25;return _regeneratorRuntime.awrap(_this.setState({busLine:_BuslineTemp}));case 25:case\"end\":return _context4.stop();}}});};_this.getLocation=function _callee5(){return _regeneratorRuntime.async(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:navigator.geolocation.getCurrentPosition(function(position){var latlng={latitude:parseFloat(JSON.stringify(position.coords.latitude)),longitude:parseFloat(JSON.stringify(position.coords.longitude))};var region={latitude:parseFloat(JSON.stringify(position.coords.latitude)),longitude:parseFloat(JSON.stringify(position.coords.longitude)),latitudeDelta:_this.state.region.latitudeDelta,longitudeDelta:_this.state.region.longitudeDelta};_this.setState({latlng:latlng,region:region});},function(error){return alert(error.message);},{enableHighAccuracy:true,timeout:20000,maximumAge:1000});_context5.next=3;return _regeneratorRuntime.awrap(navigator.geolocation.watchPosition(function(position){var latlng={latitude:parseFloat(JSON.stringify(position.coords.latitude)),longitude:parseFloat(JSON.stringify(position.coords.longitude))};var region={latitude:parseFloat(JSON.stringify(position.coords.latitude)),longitude:parseFloat(JSON.stringify(position.coords.longitude)),latitudeDelta:_this.state.region.latitudeDelta,longitudeDelta:_this.state.region.longitudeDelta};_this.setState({latlng:latlng,region:region});}));case 3:_this.watchID=_context5.sent;case 4:case\"end\":return _context5.stop();}}});};_this.fetchbusActiveData=function _callee6(){var _this$state,searchTxt,busLine,lineQuery,response,_BusActive,_response3,_BusActive2;return _regeneratorRuntime.async(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_this$state=_this.state,searchTxt=_this$state.searchTxt,busLine=_this$state.busLine;lineQuery=[];if(!(searchTxt==\"\")){_context6.next=14;break;}_context6.next=5;return _regeneratorRuntime.awrap(fetch(SettingApp+\"/getVehicleActive\"));case 5:response=_context6.sent;_context6.next=8;return _regeneratorRuntime.awrap(response.json());case 8:_BusActive=_context6.sent;console.log(\"BusActive :::: \",_BusActive);_context6.next=12;return _regeneratorRuntime.awrap(_this.setState({BusActive:_BusActive}));case 12:_context6.next=23;break;case 14:busLine.map(function(item){lineQuery.push(item.data.busline_code);});_context6.next=17;return _regeneratorRuntime.awrap(fetch(SettingApp+\"/getVehicleActiveQuery?Vehicle_Type='bus'&lineQuery=\"+lineQuery));case 17:_response3=_context6.sent;_context6.next=20;return _regeneratorRuntime.awrap(_response3.json());case 20:_BusActive2=_context6.sent;_context6.next=23;return _regeneratorRuntime.awrap(_this.setState({BusActive:_BusActive2}));case 23:case\"end\":return _context6.stop();}}});};_this.componentWillUnmount=function(){navigator.geolocation.clearWatch(_this.watchID);clearInterval(_this.intervalID);};_this.onOutFocus=function _callee7(){return _regeneratorRuntime.async(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:Keyboard.dismiss();_context7.next=3;return _regeneratorRuntime.awrap(_this.setState({typing:false,searchTxt:''}));case 3:_context7.next=5;return _regeneratorRuntime.awrap(_this.fetchData());case 5:_context7.next=7;return _regeneratorRuntime.awrap(_this.fetchbusLineData());case 7:_context7.next=9;return _regeneratorRuntime.awrap(_this.fetchbusActiveData());case 9:case\"end\":return _context7.stop();}}});};_this.onSearchSubmit=function _callee8(){return _regeneratorRuntime.async(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return _regeneratorRuntime.awrap(_this.setState({typing:false}));case 2:_context8.next=4;return _regeneratorRuntime.awrap(_this.fetchData());case 4:_context8.next=6;return _regeneratorRuntime.awrap(_this.fetchbusLineData());case 6:_context8.next=8;return _regeneratorRuntime.awrap(_this.fetchbusActiveData());case 8:case\"end\":return _context8.stop();}}});};_this.openDetail=function(id){var busLine=_this.state.busLine;var tempIndex=busLine.findIndex(function(e){return e.data.busline_code==id;});busLine[tempIndex].show=!busLine[tempIndex].show;_this.setState({busLine:busLine});};_this.onRegionChangeComplete=function _callee9(region){return _regeneratorRuntime.async(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.prev=0;_context9.next=3;return _regeneratorRuntime.awrap(AsyncStorage.setItem('@region',JSON.stringify(region)));case 3:_context9.next=8;break;case 5:_context9.prev=5;_context9.t0=_context9[\"catch\"](0);console.log(_context9.t0);case 8:case\"end\":return _context9.stop();}}},null,null,[[0,5]]);};_this.openMenuFunc=function _callee10(){var value;return _regeneratorRuntime.async(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.prev=0;_context10.next=3;return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"@region\"));case 3:value=_context10.sent;if(!(value!==null)){_context10.next=7;break;}_context10.next=7;return _regeneratorRuntime.awrap(_this.setState({region:JSON.parse(value)}));case 7:_context10.next=12;break;case 9:_context10.prev=9;_context10.t0=_context10[\"catch\"](0);console.log(_context10.t0);case 12:_this.setState({openMenu:!_this.state.openMenu});case 13:case\"end\":return _context10.stop();}}},null,null,[[0,9]]);};return _this;}_createClass(App,[{key:\"render\",value:function render(){var _this2=this;var _this$state2=this.state,region=_this$state2.region,latlng=_this$state2.latlng;return React.createElement(View,{style:styles.container},React.createElement(StatusBar,{barStyle:\"dark-content\"}),React.createElement(MapView,{provider:PROVIDER_GOOGLE,style:styles.map,onRegionChange:this.onRegionChangeComplete,region:this.state.region},this.state.busStop.map(function(marker,key){var LatLng={latitude:parseFloat(marker.latitude),longitude:parseFloat(marker.longitude)};return React.createElement(Marker,{key:key,coordinate:LatLng,title:marker.busstop_name,description:marker.description},React.createElement(BusStopIcon,{textLine:marker.busline_name}));}),this.state.BusActive.map(function(marker,key){var LatLng={latitude:parseFloat(marker.lat)||10000,longitude:parseFloat(marker.lon)||10000};console.log(\"marker---------------\",marker.Vehicle_Type);return React.createElement(Marker,{key:key,coordinate:LatLng,title:marker.busstop_name,description:marker.Vehicle_Name},marker.Vehicle_Type==\"Bus\"&&marker.BreakDown_Status==0?React.createElement(BusActive,{textLine:marker.busline_code}):marker.Vehicle_Type==\"Bus\"&&marker.BreakDown_Status==1?React.createElement(BusBreakDown,{textLine:marker.busline_code}):marker.Vehicle_Type==\"Boat\"&&marker.BreakDown_Status==0?React.createElement(BoatActive,{textLine:marker.busline_code}):marker.Vehicle_Type==\"Boat\"&&marker.BreakDown_Status==1?React.createElement(BoatBreakDown,{textLine:marker.busline_code}):marker.Vehicle_Type==\"Van\"&&marker.BreakDown_Status==0?React.createElement(VanActive,{textLine:marker.busline_code}):marker.Vehicle_Type==\"Van\"&&marker.BreakDown_Status==1?React.createElement(VanBreakDown,{textLine:marker.busline_code}):marker.Vehicle_Type==\"Truck\"&&marker.BreakDown_Status==0?React.createElement(TruckActive,{textLine:marker.busline_code}):marker.Vehicle_Type==\"Truck\"&&marker.BreakDown_Status==1?React.createElement(TruckBreakDown,{textLine:marker.busline_code}):React.createElement(React.Fragment,null));}),React.createElement(Marker,{coordinate:this.state.latlng,title:this.state.markers.title,description:this.state.markers.description},React.createElement(View,null,React.createElement(Image,{source:require(\"../assets/icon/self-map-marker.png\"),style:{width:70,height:70,zIndex:100}})))),React.createElement(MenuSlide,{openMenu:this.state.openMenu},React.createElement(TouchableOpacity,{style:{width:Dimensions.get(\"window\").width},onPress:function onPress(){return _this2.openMenuFunc();}},React.createElement(TextMenuSlide,{openMenu:this.state.openMenu},\"Bus\")),React.createElement(TouchableOpacity,{style:styles.Line,onPress:function onPress(){return _this2.openMenuFunc();}}),React.createElement(ScrollView,null,this.state.busLine.map(function(item,key){return React.createElement(BusStopDetail,{key:key,data:item.data,show:item.show,openDetail:_this2.openDetail});}))),React.createElement(SearchTab,{typing:this.state.typing},React.createElement(Image,{source:require(\"../assets/icon/search.png\"),style:{width:30,height:30},onPress:function onPress(){return _this2.setState({typing:false});}}),React.createElement(TextInput,{placeholder:\"Where to ?\",style:styles.InputStyle,onChangeText:function onChangeText(searchTxt){return _this2.setState({searchTxt:searchTxt});},value:this.state.searchTxt,blurOnSubmit:true,onFocus:function onFocus(){return _this2.setState({typing:true});},onSubmitEditing:function onSubmitEditing(){return _this2.onSearchSubmit();}}),this.state.typing&&React.createElement(TouchableOpacity,{onPress:function onPress(){return _this2.onOutFocus();}},React.createElement(Image,{source:require(\"../assets/icon/close.png\"),style:{width:20,height:20}}))));}}]);return App;}(React.Component);App.navigationOptions={title:\"Bus\",gesturesEnabled:false};export{App as default};var width=Dimensions.get(\"window\").width;var height=Dimensions.get(\"window\").height;var styles=StyleSheet.create({container:{flex:3,justifyContent:\"flex-end\",alignItems:\"center\"},map:_objectSpread({},StyleSheet.absoluteFillObject),Line:{width:90,height:6,backgroundColor:\"rgb(71, 69, 245)\",top:0,position:\"absolute\",borderRadius:50,marginTop:10},ViewFlex:{width:width-70,flexDirection:\"row\",paddingTop:20,paddingBottom:20,marginStart:30,marginEnd:30,justifyContent:\"flex-start\",alignItems:\"center\",borderBottomWidth:1,borderBottomColor:'rgba(255,255,255,0.5)'},LineFlex:{marginTop:20,width:300,height:0.5,backgroundColor:\"rgba(255,255,255,0.5)\",borderRadius:50},InputStyle:{marginTop:20,paddingBottom:20,fontSize:30,width:250,textAlign:\"center\",color:\"rgb(29, 25, 204)\"}});var MenuSlide=styled(View)(_templateObject(),width,function(props){return props.openMenu?500:150;},function(props){return props.openMenu?250:height-250;});var SearchTab=styled(View)(_templateObject2(),width,height-180,function(props){return props.typing?300:0;});var TextMenuSlide=styled(Text)(_templateObject3());","map":{"version":3,"sources":["/Users/thanutpond/Desktop/whereApp/screens/ShowMap.js"],"names":["React","Dimensions","MapView","PROVIDER_GOOGLE","Marker","BusStopIcon","BusActive","VanBreakDown","BoatBreakDown","TruckBreakDown","BusBreakDown","TruckActive","VanActive","BoatActive","BusStopDetail","styled","SettingApp","moment","locale","App","state","typing","searchTxt","openMenu","markers","title","description","open","User","region","latitude","longitude","latitudeDelta","longitudeDelta","tempRegion","latlng","busStop","busLine","componentDidMount","AsyncStorage","getItem","value","setState","JSON","parse","console","log","getLocation","fetchData","fetchbusLineData","fetchbusActiveData","intervalID","setInterval","RefreshMaps","fetch","response","json","tempBusStop","BuslineTemp","map","e","push","data","show","busLine2","key","navigator","geolocation","getCurrentPosition","position","parseFloat","stringify","coords","error","alert","message","enableHighAccuracy","timeout","maximumAge","watchPosition","watchID","lineQuery","item","busline_code","componentWillUnmount","clearWatch","clearInterval","onOutFocus","Keyboard","dismiss","onSearchSubmit","openDetail","id","tempIndex","findIndex","onRegionChangeComplete","setItem","openMenuFunc","styles","container","marker","LatLng","busstop_name","busline_name","lat","lon","Vehicle_Type","Vehicle_Name","BreakDown_Status","require","width","height","zIndex","get","Line","InputStyle","Component","navigationOptions","gesturesEnabled","StyleSheet","create","flex","justifyContent","alignItems","absoluteFillObject","backgroundColor","top","borderRadius","marginTop","ViewFlex","flexDirection","paddingTop","paddingBottom","marginStart","marginEnd","borderBottomWidth","borderBottomColor","LineFlex","fontSize","textAlign","color","MenuSlide","View","props","SearchTab","TextMenuSlide","Text"],"mappings":"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","sourcesContent":["import React from \"react\"\nDimensions\nimport {\n  View,\n  Text,\n  StyleSheet,\n  Image,\n  TouchableOpacity,\n  Dimensions,\n  StatusBar,\n  TextInput,\n  Keyboard,\n  ScrollView\n} from \"react-native\"\nimport MapView, { PROVIDER_GOOGLE } from \"react-native-maps\" // remove PROVIDER_GOOGLE import if not using Google Maps\nimport { Marker } from \"react-native-maps\"\nimport BusStopIcon from \"../components/BusStop\"\nimport BusActive from \"../components/BusActive\"\nimport VanBreakDown from \"../components/VanBreakDown\"\nimport BoatBreakDown from \"../components/BoatBreakDown\"\nimport TruckBreakDown from \"../components/TruckBreakDown\"\nimport BusBreakDown from \"../components/BusBreakDown\"\nimport TruckActive from \"../components/TruckActive\"\nimport VanActive from \"../components/VanActive\"\nimport BoatActive from \"../components/BoatActive\"\nimport BusStopDetail from \"../components/BusStopDetail\"\nimport styled from \"styled-components\"\nimport {SettingApp} from '../appConfig';\nimport { AsyncStorage } from \"react-native\";\nimport moment from \"moment\";\nimport \"moment/locale/th\"; // without this line it didn't work\nmoment.locale(\"th\");\n\nexport default class App extends React.Component {\n  static navigationOptions = {\n    title: \"Bus\",\n    gesturesEnabled: false,\n  }\n\n  state = {\n    typing: false, // check keyboard\n    searchTxt: \"\", // เก็บค่าคำที่ใช้ค้นหา\n    openMenu: false, // ค่าเปิดปิด Menu\n    markers: [ // เก็บค่าตำแหน่งปัจจุบันของ User\n      {\n        title: \"Your Location\",\n        description: \"คุณอยู่ที่นี่\"\n      }\n    ],\n    open : false, // ค่าเปิดปิด Search\n    User : '', // เก็บค่า User จาก Localstorage\n    region : { // เก็บค่าตำแหน่งของ Maps ขณะนั้น\n      latitude: 0, \n      longitude: 0,\n      latitudeDelta: 0.015,\n      longitudeDelta: 0.0121\n    },\n    tempRegion : {}, //  เก็บค่าตำแหน่งของ Maps ชั่วคราว\n    latlng: { //\n      latitude: 0,////////// UpdateState Every 5 Sec\n      longitude: 0\n    }, \n    busStop: [], // เก็บข้อมูลป้ายรถ\n    busLine: [],//// เก็บข้อมูลสายรถ\n    BusActive : [] ,// เก็บข้อมูลรถที่ทำงานอยู่\n  }\n\n  componentDidMount = async () => {\n    try { // ดึงข้อมูลจาก Localstorage\n      const value = await AsyncStorage.getItem(\"@User\");\n      if (value !== null) {\n        await this.setState({ User: JSON.parse(value) });\n      }\n    } catch (error) {\n      console.log(error);\n    }\n    // เรียกFunction\n    await this.getLocation()\n    await this.fetchData()\n    await this.fetchbusLineData()\n    await this.fetchbusActiveData()\n    // เรียกFunction ทุก 5 วิ\n    this.intervalID = setInterval(() => this.RefreshMaps(), 5000);\n    \n  }\n\n  // อัพเดทค่า Maps ทุก 5 วินาที\n  RefreshMaps = async () => {\n    try { //ดึงค่าตำแหน่งของ Map ที่อยู่ใน Localstorage มาอัพเดท\n      const value = await AsyncStorage.getItem(\"@region\");\n      if (value !== null) {\n        await this.setState({ region: JSON.parse(value) });\n      }\n    } catch (error) {\n      console.log(error);\n    }\n\n    // ดึงค่าตำแหน่งรถใหม่\n    await this.fetchbusActiveData()\n  };\n\n\n  // ส่งค่าสำหรับ Search ข้อมูลไปยังหลังบ้าน\n  fetchData = async () => {\n    let {searchTxt} = this.state\n    \n    // Check ว่ามีคำค้นหาหรือไม่\n    if(searchTxt == \"\"){\n      // ถ้าไม่มีให้ใช้ Api นี้\n      const response = await fetch(`${SettingApp}/busStop?searchText=${this.state.searchTxt}`)\n      const busStop = await response.json()\n      // console.log(\"busStop :::: \", busStop)\n      await this.setState({ busStop })\n    } else {\n      // ถ้ามีให้ใช้ Api นี้ พร้อมส่งตัวแปร searchText ไปด้วย\n      const response = await fetch(`${SettingApp}/SearchBusStop?searchText=${this.state.searchTxt}`)\n      const tempBusStop = await response.json() // แปลงค่าที่รับมาเป็น Json\n      const busStop = tempBusStop[1]  //นำค่าที่ได้ใส่ในตัวแปรนี้\n      await this.setState({ busStop })\n    }\n\n\n\n  }\n//////////////////////////////////////////////\n  fetchbusLineData = async () => { //ดึงข้อมูลสายรถ\n    let {searchTxt} = this.state\n    \n    if(searchTxt == \"\"){  // Check ว่ามีคำค้นหาหรือไม่\n      const response = await fetch(`${SettingApp}/busLine?searchText=${this.state.searchTxt}`)\n      const busLine = await response.json()\n      // console.log(\"busLine :::: \", busLine)\n      let BuslineTemp = []\n      // นำสายรถมาใส่ในตัวแปร โดยจัดรูปแบบใหม่\n      busLine.map(e => {\n        BuslineTemp.push({ data : e, show : false})\n      })\n      await this.setState({ busLine : BuslineTemp })\n    }\n    else {\n      // ถ้ามีคำค้นหา \n      const response = await fetch(`${SettingApp}/SearchBusStop?searchText=${this.state.searchTxt}`)\n      const busLine = await response.json()\n      let busLine2 = busLine[0]\n      let BuslineTemp = []\n      busLine2.map((e, key) => {\n        BuslineTemp.push({ data : e, show : false})\n      })\n      await this.setState({ busLine : BuslineTemp })\n    }\n  }\n\n\n  // ดึงข้อมูลตำแหน่งปัจจุบันของ User Code เป็น Pattle ของ getLocation\n  getLocation = async () => {\n    navigator.geolocation.getCurrentPosition(\n      position => {\n        //// นำค่าที่ได้มาเก็บในตัวแปรที่ตั้งไว้\n        let latlng = {\n          latitude: parseFloat(JSON.stringify(position.coords.latitude)),\n          longitude: parseFloat(JSON.stringify(position.coords.longitude))\n        }\n        let region ={\n          latitude: parseFloat(JSON.stringify(position.coords.latitude)),\n          longitude: parseFloat(JSON.stringify(position.coords.longitude)),\n          latitudeDelta : this.state.region.latitudeDelta,\n          longitudeDelta : this.state.region.longitudeDelta\n        }\n        \n        this.setState({ latlng , region  })\n        // console.log(\"re :::: \",this.state.region)\n      },\n      error => alert(error.message),\n      { enableHighAccuracy: true, timeout: 20000, maximumAge: 1000 }\n    )\n    this.watchID = await navigator.geolocation.watchPosition(position => {\n      let latlng = {\n        latitude: parseFloat(JSON.stringify(position.coords.latitude)),\n        longitude: parseFloat(JSON.stringify(position.coords.longitude))\n      }\n      let region ={\n        latitude: parseFloat(JSON.stringify(position.coords.latitude)),\n        longitude: parseFloat(JSON.stringify(position.coords.longitude)),\n        latitudeDelta : this.state.region.latitudeDelta,\n        longitudeDelta : this.state.region.longitudeDelta\n      }\n      this.setState({ latlng , region })\n    })\n  }\n\n  // ดึงข้อมูลรถที่กำลังวิ่งอยู่\n  fetchbusActiveData = async () => {\n    let {searchTxt, busLine} = this.state\n    let lineQuery = [] //สร้างตัวแปรสำหรับเก็บสายรถ\n    if(searchTxt == \"\"){ \n    const response = await fetch(`${SettingApp}/getVehicleActive`)\n    const BusActive = await response.json()\n    console.log(\"BusActive :::: \", BusActive)\n    await this.setState({ BusActive})\n    }else { \n      busLine.map(item => {\n        lineQuery.push(item.data.busline_code)\n      })\n      const response = await fetch(`${SettingApp}/getVehicleActiveQuery?Vehicle_Type='bus'&lineQuery=${lineQuery}`)\n      const BusActive = await response.json()\n      await this.setState({ BusActive})\n    }\n  }\n\n  \n  componentWillUnmount = () => {\n    navigator.geolocation.clearWatch(this.watchID)\n    clearInterval(this.intervalID);\n  }\n\n  // เมื่อไม่ได้ทำการพิมพ์ค้นหา\n  onOutFocus = async () => {\n    Keyboard.dismiss()\n    await this.setState({ typing: false, searchTxt : '' })\n    await this.fetchData()\n    await this.fetchbusLineData()\n    await this.fetchbusActiveData()\n\n  }\n\n  // กดตกลงค้นหา\n  onSearchSubmit = async () => {\n    await this.setState({ typing: false })\n    await this.fetchData()\n    await this.fetchbusLineData()\n    await this.fetchbusActiveData()\n\n  }\n\n\n  // เปิดข้อมูลของแต่ละสาย\n  openDetail = (id) => {\n    let { busLine } = this.state;\n    // นำไอดีที่ได้มาเทียบกับข้อมูลเพื่อเปิดข้อมูลที่เลือก\n    const tempIndex = busLine.findIndex( e => {\n        return e.data.busline_code == id\n    });\n    busLine[tempIndex].show = !busLine[tempIndex].show;\n    this.setState({busLine});\n} \n\n  /// เก็บค่าที่ map ที่เปลี่ยนใน Localstorage\n  onRegionChangeComplete = async(region) => {\n    // console.log('onRegionChangeComplete ::: ', region);\n    try {\n      await AsyncStorage.setItem('@region', JSON.stringify(region));\n    } catch (error) {\n      console.log(error)\n    }\n  };\n\n  // เปิดเมนูและทำการเก็บค่าที่ map ที่เปลี่ยนใน Localstorage\n  openMenuFunc = async() => {\n    try {\n      const value = await AsyncStorage.getItem(\"@region\");\n      if (value !== null) {\n        await this.setState({ region: JSON.parse(value) });\n      }\n    } catch (error) {\n      console.log(error);\n    }\n    this.setState({ openMenu: !this.state.openMenu })\n  }\n\n\n\n  render() {\n    let {region, latlng} = this.state\n    return (\n      <View style={styles.container}>\n        <StatusBar barStyle=\"dark-content\" />\n        <MapView\n          provider={PROVIDER_GOOGLE} // remove if not using Google Maps\n          style={styles.map}\n          onRegionChange={this.onRegionChangeComplete}\n          region={this.state.region}\n        >\n         \n          {this.state.busStop.map((marker, key) => {\n            let LatLng = {\n              latitude: parseFloat(marker.latitude),\n              longitude: parseFloat(marker.longitude)\n            }\n            return (\n              <Marker\n                key={key}\n                coordinate={LatLng}\n                title={marker.busstop_name}\n                description={marker.description}\n              >\n                <BusStopIcon textLine={marker.busline_name} />\n              </Marker>\n            )\n          })}\n          {/* นำค่ารถที่กำลังวิ่งอยู่มาแสดง */}\n          {this.state.BusActive.map((marker, key) => {\n            let LatLng = {\n              latitude: parseFloat(marker.lat) || 10000,\n              longitude: parseFloat(marker.lon) || 10000\n            }\n            console.log(\"marker---------------\",marker.Vehicle_Type)\n            return (\n              <Marker\n                key={key}\n                coordinate={LatLng}\n                title={marker.busstop_name}\n                description={marker.Vehicle_Name}\n              >\n                { \n                marker.Vehicle_Type == \"Bus\" && marker.BreakDown_Status == 0 ? <BusActive textLine={marker.busline_code}   /> : \n                marker.Vehicle_Type == \"Bus\" && marker.BreakDown_Status == 1 ? <BusBreakDown textLine={marker.busline_code}   /> : \n                marker.Vehicle_Type == \"Boat\" && marker.BreakDown_Status == 0 ? <BoatActive textLine={marker.busline_code}   /> : \n                marker.Vehicle_Type == \"Boat\" && marker.BreakDown_Status == 1 ? <BoatBreakDown textLine={marker.busline_code}   /> : \n                marker.Vehicle_Type == \"Van\" && marker.BreakDown_Status == 0 ? <VanActive textLine={marker.busline_code}   /> : \n                marker.Vehicle_Type == \"Van\" && marker.BreakDown_Status == 1 ? <VanBreakDown textLine={marker.busline_code}   /> : \n                marker.Vehicle_Type == \"Truck\" && marker.BreakDown_Status == 0 ? <TruckActive textLine={marker.busline_code}   /> : \n                marker.Vehicle_Type == \"Truck\" && marker.BreakDown_Status == 1 ? <TruckBreakDown textLine={marker.busline_code}   /> : <></>                \n                }\n              </Marker>\n            )\n          })}\n          {/* นำค่าตำแหน่งปัจจุบันของ User มา Show*/}\n           <Marker\n            coordinate={this.state.latlng}\n            title={this.state.markers.title}\n            description={this.state.markers.description}\n          >\n            <View>\n              <Image\n                source={require(\"../assets/icon/self-map-marker.png\")}\n                style={{ width: 70, height: 70, zIndex : 100 }}\n              />\n              {/* <Text>คุณอยู่ที่นี่</Text> */}\n            </View>\n          </Marker>\n        </MapView>\n{/* //////////////////////////////////////////////////////////////// */}\n\n        <MenuSlide\n          openMenu={this.state.openMenu}\n        >\n         <TouchableOpacity style={{width : Dimensions.get(\"window\").width}} onPress={() => this.openMenuFunc()}>\n            <TextMenuSlide openMenu={this.state.openMenu}>Bus</TextMenuSlide>\n         </TouchableOpacity>\n          <TouchableOpacity style={styles.Line} onPress={() => this.openMenuFunc()}/>\n          <ScrollView >\n            {this.state.busLine.map((item, key) => (\n              // <View key={key}></View>\n              <BusStopDetail key={key} data={item.data} show={item.show} openDetail={this.openDetail} />\n            ))}\n          </ScrollView>\n        </MenuSlide>\n\n{/* //////////////////////////////////////////////////////////////// */}\n\n        <SearchTab typing={this.state.typing}>\n          <Image\n            source={require(\"../assets/icon/search.png\")}\n            style={{ width: 30, height: 30}}\n            onPress={() => this.setState({ typing: false })}\n          />\n\n          {/* <KeyboardAwareScrollView styles={{}}> */}\n          <TextInput\n            placeholder=\"Where to ?\"\n            style={styles.InputStyle}\n            onChangeText={searchTxt => this.setState({ searchTxt })}\n            value={this.state.searchTxt}\n            blurOnSubmit={true}\n            onFocus={() => this.setState({ typing: true })}\n            onSubmitEditing={() => this.onSearchSubmit()}\n          />\n          {/* </KeyboardAwareScrollView> */}\n\n          {this.state.typing && (\n            <TouchableOpacity onPress={() => this.onOutFocus()}>\n              <Image\n                source={require(\"../assets/icon/close.png\")}\n                style={{ width: 20, height: 20 }}\n              />\n            </TouchableOpacity>\n          )}\n        </SearchTab>\n\n        {/* ///////////////////////////////////////////////////// */}\n      </View>\n    )\n  }\n}\n\n\n// ดึงค่า Width Height ของหน้าจอ\nlet width = Dimensions.get(\"window\").width\nlet height = Dimensions.get(\"window\").height\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 3,\n    justifyContent: \"flex-end\",\n    alignItems: \"center\"\n  },\n  map: {\n    ...StyleSheet.absoluteFillObject\n  },\n  Line: {\n    width: 90,\n    height: 6,\n    backgroundColor: \"rgb(71, 69, 245)\",\n    top: 0,\n    position: \"absolute\",\n    borderRadius: 50,\n    marginTop: 10\n  },\n  ViewFlex: {\n    width : width-70,\n    flexDirection: \"row\",\n    paddingTop : 20,\n    paddingBottom : 20,\n    marginStart :30,\n    marginEnd : 30,\n    justifyContent: \"flex-start\",\n    alignItems: \"center\",\n    borderBottomWidth : 1,\n    borderBottomColor : 'rgba(255,255,255,0.5)',\n  },\n  LineFlex: {\n   marginTop : 20,\n    width: 300,\n    height: 0.5,\n    backgroundColor: \"rgba(255,255,255,0.5)\",\n    borderRadius: 50,\n  },\n  InputStyle: {\n    marginTop: 20,\n    paddingBottom: 20,\n    fontSize: 30,\n    width: 250,\n    textAlign: \"center\",\n    color: \"rgb(29, 25, 204)\"\n  }\n})\n\nconst MenuSlide = styled(View)`\n  width: ${width};\n  height: ${props => props.openMenu ? 500 : 150};\n  position:absolute;\n  top:${props => props.openMenu ? 250 : height-250};   \n  backgroundColor: 'rgb(29,25,204)';\n  borderRadius: 60;\n  borderBottomEndRadius :  0;\n  borderBottomStartRadius :  0;\n  borderWidth: 0;\n  justifyContent: flex-start;\n  alignItems: center;\n  paddingTop : 15;\n  paddingBottom : 50;\n`;\n\nconst SearchTab = styled(View)`\n  width: ${width};\n  height: 90;\n  backgroundColor: white;\n  borderRadius: 60;\n  borderBottomEndRadius :  0;\n  borderBottomStartRadius :  0;\n  borderWidth: 0;\n  justifyContent: center;\n  alignItems: center;\n  marginTop : ${height-180};\n  marginBottom : ${props => props.typing ? 300 : 0}\n  flexDirection: row;\n`;\n\nconst TextMenuSlide = styled(Text)`\n  fontSize: 30;\n  color: 'rgb(101,102,251)';\n  textAlign: center;\n  paddingLeft: 10;\n  paddingRight: 10;\n  marginTop: 10;\n`"]},"metadata":{},"sourceType":"module"}