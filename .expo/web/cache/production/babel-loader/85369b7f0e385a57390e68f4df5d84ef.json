{"ast":null,"code":"import _taggedTemplateLiteralLoose from\"@babel/runtime/helpers/taggedTemplateLiteralLoose\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";import _inherits from\"@babel/runtime/helpers/inherits\";function _templateObject3(){var data=_taggedTemplateLiteralLoose([\"\\n  fontSize: 30;\\n  color: 'rgb(101,102,251)';\\n  textAlign: center;\\n  paddingLeft: 10;\\n  paddingRight: 10;\\n  marginTop: 10;\\n\"]);_templateObject3=function _templateObject3(){return data;};return data;}function _templateObject2(){var data=_taggedTemplateLiteralLoose([\"\\n  width: \",\";\\n  height: 90;\\n  backgroundColor: white;\\n  borderRadius: 60;\\n  borderBottomEndRadius :  0;\\n  borderBottomStartRadius :  0;\\n  borderWidth: 0;\\n  justifyContent: center;\\n  alignItems: center;\\n  marginTop : \",\";\\n  marginBottom : \",\"\\n  flexDirection: row;\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteralLoose([\"\\n  width: \",\";\\n  height: \",\";\\n  position:absolute;\\n  top:\",\";   \\n  backgroundColor: 'rgb(29,25,204)';\\n  borderRadius: 60;\\n  borderBottomEndRadius :  0;\\n  borderBottomStartRadius :  0;\\n  borderWidth: 0;\\n  justifyContent: flex-start;\\n  alignItems: center;\\n  paddingTop : 15;\\n  paddingBottom : 50;\\n\"]);_templateObject=function _templateObject(){return data;};return data;}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import React from\"react\";Dimensions;import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Image from\"react-native-web/dist/exports/Image\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import Dimensions from\"react-native-web/dist/exports/Dimensions\";import StatusBar from\"react-native-web/dist/exports/StatusBar\";import TextInput from\"react-native-web/dist/exports/TextInput\";import Keyboard from\"react-native-web/dist/exports/Keyboard\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import MapView,{PROVIDER_GOOGLE}from\"react-native-maps\";import{Marker}from\"react-native-maps\";import BusStopIcon from\"../components/BusStop\";import VanActive from\"../components/VanActive\";import BusStopDetail from\"../components/BusStopDetail\";import styled from\"styled-components\";import{SettingApp}from\"../appConfig\";import AsyncStorage from\"react-native-web/dist/exports/AsyncStorage\";import moment from\"moment\";import\"moment/locale/th\";moment.locale(\"th\");var App=function(_React$Component){_inherits(App,_React$Component);function App(){var _getPrototypeOf2;var _this;_classCallCheck(this,App);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(App)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={typing:false,searchTxt:\"\",openMenu:false,markers:[{title:\"Your Location\",description:\"คุณอยู่ที่นี่\"}],open:false,User:'',region:{latitude:0,longitude:0,latitudeDelta:0.015,longitudeDelta:0.0121},latlng:{latitude:0,longitude:0},busStop:[],busLine:[],BusActive:[]};_this.componentDidMount=function _callee(){var value;return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"@User\"));case 3:value=_context.sent;if(!(value!==null)){_context.next=7;break;}_context.next=7;return _regeneratorRuntime.awrap(_this.setState({User:JSON.parse(value)}));case 7:_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 12:_context.next=14;return _regeneratorRuntime.awrap(_this.getLocation());case 14:_context.next=16;return _regeneratorRuntime.awrap(_this.fetchData());case 16:_context.next=18;return _regeneratorRuntime.awrap(_this.fetchbusLineData());case 18:_context.next=20;return _regeneratorRuntime.awrap(_this.fetchbusActiveData());case 20:_this.intervalID=setInterval(function(){return _this.RefreshMaps();},5000);case 21:case\"end\":return _context.stop();}}},null,null,[[0,9]]);};_this.RefreshMaps=function _callee2(){var value;return _regeneratorRuntime.async(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"@region\"));case 3:value=_context2.sent;if(!(value!==null)){_context2.next=7;break;}_context2.next=7;return _regeneratorRuntime.awrap(_this.setState({region:JSON.parse(value)}));case 7:_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 12:_context2.next=14;return _regeneratorRuntime.awrap(_this.fetchbusActiveData());case 14:console.log(\" time: \",moment().format(\"HH:mm:ss\"));case 15:case\"end\":return _context2.stop();}}},null,null,[[0,9]]);};_this.fetchData=function _callee3(){var searchTxt,response,busStop,_response,tempBusStop,_busStop;return _regeneratorRuntime.async(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:searchTxt=_this.state.searchTxt;if(!(searchTxt==\"\")){_context3.next=12;break;}_context3.next=4;return _regeneratorRuntime.awrap(fetch(SettingApp+\"/busStop?searchText=\"+_this.state.searchTxt));case 4:response=_context3.sent;_context3.next=7;return _regeneratorRuntime.awrap(response.json());case 7:busStop=_context3.sent;_context3.next=10;return _regeneratorRuntime.awrap(_this.setState({busStop:busStop}));case 10:_context3.next=21;break;case 12:_context3.next=14;return _regeneratorRuntime.awrap(fetch(SettingApp+\"/SearchBusStop?searchText=\"+_this.state.searchTxt));case 14:_response=_context3.sent;_context3.next=17;return _regeneratorRuntime.awrap(_response.json());case 17:tempBusStop=_context3.sent;_busStop=tempBusStop[1];_context3.next=21;return _regeneratorRuntime.awrap(_this.setState({busStop:_busStop}));case 21:case\"end\":return _context3.stop();}}});};_this.fetchbusLineData=function _callee4(){var searchTxt,response,busLine,BuslineTemp,_response2,_busLine,busLine2,_BuslineTemp;return _regeneratorRuntime.async(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:searchTxt=_this.state.searchTxt;if(!(searchTxt==\"\")){_context4.next=14;break;}_context4.next=4;return _regeneratorRuntime.awrap(fetch(SettingApp+\"/busLine?searchText=\"+_this.state.searchTxt));case 4:response=_context4.sent;_context4.next=7;return _regeneratorRuntime.awrap(response.json());case 7:busLine=_context4.sent;BuslineTemp=[];busLine.map(function(e){BuslineTemp.push({data:e,show:false});});_context4.next=12;return _regeneratorRuntime.awrap(_this.setState({busLine:BuslineTemp}));case 12:_context4.next=25;break;case 14:_context4.next=16;return _regeneratorRuntime.awrap(fetch(SettingApp+\"/SearchBusStop?searchText=\"+_this.state.searchTxt));case 16:_response2=_context4.sent;_context4.next=19;return _regeneratorRuntime.awrap(_response2.json());case 19:_busLine=_context4.sent;busLine2=_busLine[0];_BuslineTemp=[];busLine2.map(function(e,key){_BuslineTemp.push({data:e,show:false});});_context4.next=25;return _regeneratorRuntime.awrap(_this.setState({busLine:_BuslineTemp}));case 25:case\"end\":return _context4.stop();}}});};_this.getLocation=function _callee5(){return _regeneratorRuntime.async(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:navigator.geolocation.getCurrentPosition(function(position){var latlng={latitude:parseFloat(JSON.stringify(position.coords.latitude)),longitude:parseFloat(JSON.stringify(position.coords.longitude))};var region={latitude:parseFloat(JSON.stringify(position.coords.latitude)),longitude:parseFloat(JSON.stringify(position.coords.longitude)),latitudeDelta:0.015,longitudeDelta:0.0121};_this.setState({latlng:latlng,region:region});},function(error){return alert(error.message);},{enableHighAccuracy:true,timeout:20000,maximumAge:1000});_context5.next=3;return _regeneratorRuntime.awrap(navigator.geolocation.watchPosition(function(position){var latlng={latitude:parseFloat(JSON.stringify(position.coords.latitude)),longitude:parseFloat(JSON.stringify(position.coords.longitude))};var region={latitude:parseFloat(JSON.stringify(position.coords.latitude)),longitude:parseFloat(JSON.stringify(position.coords.longitude)),latitudeDelta:0.015,longitudeDelta:0.0121};_this.setState({latlng:latlng,region:region});}));case 3:_this.watchID=_context5.sent;case 4:case\"end\":return _context5.stop();}}});};_this.fetchbusActiveData=function _callee6(){var _this$state,searchTxt,busLine,lineQuery,response,BusActive,_response3,_BusActive;return _regeneratorRuntime.async(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_this$state=_this.state,searchTxt=_this$state.searchTxt,busLine=_this$state.busLine;lineQuery=[];if(!(searchTxt==\"\")){_context6.next=13;break;}_context6.next=5;return _regeneratorRuntime.awrap(fetch(SettingApp+\"/getVehicleActive?Vehicle_Type='Van'\"));case 5:response=_context6.sent;_context6.next=8;return _regeneratorRuntime.awrap(response.json());case 8:BusActive=_context6.sent;_context6.next=11;return _regeneratorRuntime.awrap(_this.setState({BusActive:BusActive}));case 11:_context6.next=22;break;case 13:busLine.map(function(item){lineQuery.push(item.data.busline_code);});_context6.next=16;return _regeneratorRuntime.awrap(fetch(SettingApp+\"/getVehicleActiveQuery?Vehicle_Type='Van'&lineQuery=\"+lineQuery));case 16:_response3=_context6.sent;_context6.next=19;return _regeneratorRuntime.awrap(_response3.json());case 19:_BusActive=_context6.sent;_context6.next=22;return _regeneratorRuntime.awrap(_this.setState({BusActive:_BusActive}));case 22:case\"end\":return _context6.stop();}}});};_this.componentWillUnmount=function(){clearInterval(_this.intervalID);navigator.geolocation.clearWatch(_this.watchID);};_this.onOutFocus=function _callee7(){return _regeneratorRuntime.async(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:Keyboard.dismiss();_context7.next=3;return _regeneratorRuntime.awrap(_this.setState({typing:false,searchTxt:''}));case 3:_context7.next=5;return _regeneratorRuntime.awrap(_this.fetchData());case 5:_context7.next=7;return _regeneratorRuntime.awrap(_this.fetchbusLineData());case 7:_context7.next=9;return _regeneratorRuntime.awrap(_this.fetchbusActiveData());case 9:case\"end\":return _context7.stop();}}});};_this.onSearchSubmit=function _callee8(){return _regeneratorRuntime.async(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return _regeneratorRuntime.awrap(_this.setState({typing:false}));case 2:_context8.next=4;return _regeneratorRuntime.awrap(_this.fetchData());case 4:_context8.next=6;return _regeneratorRuntime.awrap(_this.fetchbusLineData());case 6:_context8.next=8;return _regeneratorRuntime.awrap(_this.fetchbusActiveData());case 8:case\"end\":return _context8.stop();}}});};_this.openDetail=function(id){var busLine=_this.state.busLine;var tempIndex=busLine.findIndex(function(e){return e.data.busline_code==id;});busLine[tempIndex].show=!busLine[tempIndex].show;_this.setState({busLine:busLine});};_this.onRegionChangeComplete=function _callee9(region){return _regeneratorRuntime.async(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:console.log('onRegionChangeComplete ::: ',region);_context9.prev=1;_context9.next=4;return _regeneratorRuntime.awrap(AsyncStorage.setItem('@region',JSON.stringify(region)));case 4:_context9.next=9;break;case 6:_context9.prev=6;_context9.t0=_context9[\"catch\"](1);console.log(_context9.t0);case 9:case\"end\":return _context9.stop();}}},null,null,[[1,6]]);};_this.openMenuFunc=function _callee10(){var value;return _regeneratorRuntime.async(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.prev=0;_context10.next=3;return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"@region\"));case 3:value=_context10.sent;if(!(value!==null)){_context10.next=7;break;}_context10.next=7;return _regeneratorRuntime.awrap(_this.setState({region:JSON.parse(value)}));case 7:_context10.next=12;break;case 9:_context10.prev=9;_context10.t0=_context10[\"catch\"](0);console.log(_context10.t0);case 12:_this.setState({openMenu:!_this.state.openMenu});case 13:case\"end\":return _context10.stop();}}},null,null,[[0,9]]);};return _this;}_createClass(App,[{key:\"render\",value:function render(){var _this2=this;var _this$state2=this.state,region=_this$state2.region,latlng=_this$state2.latlng;return React.createElement(View,{style:styles.container},React.createElement(StatusBar,{barStyle:\"dark-content\"}),React.createElement(MapView,{provider:PROVIDER_GOOGLE,style:styles.map,onRegionChange:this.onRegionChangeComplete,region:this.state.region},this.state.busStop.map(function(marker,key){var LatLng={latitude:parseFloat(marker.latitude),longitude:parseFloat(marker.longitude)};return React.createElement(Marker,{key:key,coordinate:LatLng,title:marker.busstop_name,description:marker.description},React.createElement(BusStopIcon,{textLine:marker.busline_name}));}),this.state.BusActive.map(function(marker,key){var LatLng={latitude:parseFloat(marker.lat)||10000,longitude:parseFloat(marker.lon)||10000};return React.createElement(Marker,{key:key,coordinate:LatLng,title:marker.busstop_name,description:marker.Vehicle_Name},React.createElement(VanActive,{textLine:marker.busline_code}));}),React.createElement(Marker,{coordinate:this.state.latlng,title:this.state.markers.title,description:this.state.markers.description},React.createElement(View,null,React.createElement(Image,{source:require(\"../assets/icon/self-map-marker.png\"),style:{width:70,height:70,zIndex:100}})))),React.createElement(MenuSlide,{openMenu:this.state.openMenu},React.createElement(TouchableOpacity,{style:{width:Dimensions.get(\"window\").width},onPress:function onPress(){return _this2.setState({openMenu:!_this2.state.openMenu});}},React.createElement(TextMenuSlide,{openMenu:this.state.openMenu},\"Van\")),React.createElement(TouchableOpacity,{style:styles.Line,onPress:function onPress(){return _this2.setState({openMenu:!_this2.state.openMenu});}}),React.createElement(ScrollView,null,this.state.busLine.map(function(item,key){return React.createElement(BusStopDetail,{key:key,data:item.data,show:item.show,openDetail:_this2.openDetail});}))),React.createElement(SearchTab,{typing:this.state.typing},React.createElement(Image,{source:require(\"../assets/icon/search.png\"),style:{width:30,height:30},onPress:function onPress(){return _this2.setState({typing:false});}}),React.createElement(TextInput,{placeholder:\"Where to ?\",style:styles.InputStyle,onChangeText:function onChangeText(searchTxt){return _this2.setState({searchTxt:searchTxt});},value:this.state.searchTxt,blurOnSubmit:true,onFocus:function onFocus(){return _this2.setState({typing:true});},onSubmitEditing:function onSubmitEditing(){return _this2.onSearchSubmit();}}),this.state.typing&&React.createElement(TouchableOpacity,{onPress:function onPress(){return _this2.onOutFocus();}},React.createElement(Image,{source:require(\"../assets/icon/close.png\"),style:{width:20,height:20}}))));}}]);return App;}(React.Component);App.navigationOptions={title:\"Van\",gesturesEnabled:false};export{App as default};var width=Dimensions.get(\"window\").width;var height=Dimensions.get(\"window\").height;var styles=StyleSheet.create({container:{flex:3,justifyContent:\"flex-end\",alignItems:\"center\"},map:_objectSpread({},StyleSheet.absoluteFillObject),Line:{width:90,height:6,backgroundColor:\"rgb(71, 69, 245)\",top:0,position:\"absolute\",borderRadius:50,marginTop:10},ViewFlex:{width:width-70,flexDirection:\"row\",paddingTop:20,paddingBottom:20,marginStart:30,marginEnd:30,justifyContent:\"flex-start\",alignItems:\"center\",borderBottomWidth:1,borderBottomColor:'rgba(255,255,255,0.5)'},LineFlex:{marginTop:20,width:300,height:0.5,backgroundColor:\"rgba(255,255,255,0.5)\",borderRadius:50},InputStyle:{marginTop:20,paddingBottom:20,fontSize:30,width:250,textAlign:\"center\",color:\"rgb(29, 25, 204)\"}});var MenuSlide=styled(View)(_templateObject(),width,function(props){return props.openMenu?500:150;},function(props){return props.openMenu?250:height-250;});var SearchTab=styled(View)(_templateObject2(),width,height-180,function(props){return props.typing?300:0;});var TextMenuSlide=styled(Text)(_templateObject3());","map":{"version":3,"sources":["/Users/thanutpond/Desktop/whereApp/screens/ShowMapVan.js"],"names":["React","Dimensions","MapView","PROVIDER_GOOGLE","Marker","BusStopIcon","VanActive","BusStopDetail","styled","SettingApp","moment","locale","App","state","typing","searchTxt","openMenu","markers","title","description","open","User","region","latitude","longitude","latitudeDelta","longitudeDelta","latlng","busStop","busLine","BusActive","componentDidMount","AsyncStorage","getItem","value","setState","JSON","parse","console","log","getLocation","fetchData","fetchbusLineData","fetchbusActiveData","intervalID","setInterval","RefreshMaps","format","fetch","response","json","tempBusStop","BuslineTemp","map","e","push","data","show","busLine2","key","navigator","geolocation","getCurrentPosition","position","parseFloat","stringify","coords","error","alert","message","enableHighAccuracy","timeout","maximumAge","watchPosition","watchID","lineQuery","item","busline_code","componentWillUnmount","clearInterval","clearWatch","onOutFocus","Keyboard","dismiss","onSearchSubmit","openDetail","id","tempIndex","findIndex","onRegionChangeComplete","setItem","openMenuFunc","styles","container","marker","LatLng","busstop_name","busline_name","lat","lon","Vehicle_Name","require","width","height","zIndex","get","Line","InputStyle","Component","navigationOptions","gesturesEnabled","StyleSheet","create","flex","justifyContent","alignItems","absoluteFillObject","backgroundColor","top","borderRadius","marginTop","ViewFlex","flexDirection","paddingTop","paddingBottom","marginStart","marginEnd","borderBottomWidth","borderBottomColor","LineFlex","fontSize","textAlign","color","MenuSlide","View","props","SearchTab","TextMenuSlide","Text"],"mappings":"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","sourcesContent":["import React from \"react\"\nDimensions\nimport {\n  View,\n  Text,\n  StyleSheet,\n  Image,\n  TouchableOpacity,\n  Dimensions,\n  StatusBar,\n  TextInput,\n  Keyboard,\n  ScrollView\n} from \"react-native\"\nimport MapView, { PROVIDER_GOOGLE } from \"react-native-maps\" // remove PROVIDER_GOOGLE import if not using Google Maps\nimport { Marker } from \"react-native-maps\"\nimport BusStopIcon from \"../components/BusStop\"\nimport VanActive from \"../components/VanActive\"\nimport BusStopDetail from \"../components/BusStopDetail\"\nimport styled from \"styled-components\"\nimport {SettingApp} from '../appConfig';\nimport { AsyncStorage } from \"react-native\";\nimport moment from \"moment\";\nimport \"moment/locale/th\"; // without this line it didn't work\nmoment.locale(\"th\");\n\nexport default class App extends React.Component {\n  static navigationOptions = {\n    title: \"Van\",\n    gesturesEnabled: false,\n  }\n\n  state = {\n    typing: false,\n    searchTxt: \"\",\n    openMenu: false,\n    markers: [\n      {\n        title: \"Your Location\",\n        description: \"คุณอยู่ที่นี่\"\n      }\n    ],\n    open : false,\n    User : '',\n    region : {\n      latitude: 0,\n      longitude: 0,\n      latitudeDelta: 0.015,\n      longitudeDelta: 0.0121\n    },\n    latlng: {\n      latitude: 0,////////// UpdateState Every 5 Sec\n      longitude: 0\n    },\n    busStop: [],\n    busLine: [],\n    BusActive : [],\n  }\n\n  componentDidMount = async () => {\n    try {\n      const value = await AsyncStorage.getItem(\"@User\");\n      if (value !== null) {\n        await this.setState({ User: JSON.parse(value) });\n      }\n    } catch (error) {\n      console.log(error);\n    }\n    await this.getLocation()\n    await this.fetchData()\n    await this.fetchbusLineData()\n    await this.fetchbusActiveData()\n    this.intervalID = setInterval(() => this.RefreshMaps(), 5000);\n    \n  }\n\n  RefreshMaps = async () => {\n    try {\n      const value = await AsyncStorage.getItem(\"@region\");\n      if (value !== null) {\n        await this.setState({ region: JSON.parse(value) });\n      }\n    } catch (error) {\n      console.log(error);\n    }\n\n    await this.fetchbusActiveData()\n     console.log(\" time: \",moment().format(\"HH:mm:ss\"))\n  };\n\n  fetchData = async () => {\n    let {searchTxt} = this.state\n    \n\n    if(searchTxt == \"\"){\n      const response = await fetch(`${SettingApp}/busStop?searchText=${this.state.searchTxt}`)\n      const busStop = await response.json()\n      // console.log(\"busStop :::: \", busStop)\n      await this.setState({ busStop })\n    } else {\n      const response = await fetch(`${SettingApp}/SearchBusStop?searchText=${this.state.searchTxt}`)\n      const tempBusStop = await response.json()\n      // console.log(\"tempBusStop :::: \", tempBusStop[1])\n      const busStop = tempBusStop[1]\n      await this.setState({ busStop })\n    }\n\n\n\n  }\n//////////////////////////////////////////////\n  fetchbusLineData = async () => {\n    let {searchTxt} = this.state\n    \n    if(searchTxt == \"\"){\n      const response = await fetch(`${SettingApp}/busLine?searchText=${this.state.searchTxt}`)\n      const busLine = await response.json()\n      // console.log(\"busLine :::: \", busLine)\n      let BuslineTemp = []\n      busLine.map(e => {\n        BuslineTemp.push({ data : e, show : false})\n      })\n      await this.setState({ busLine : BuslineTemp })\n    }\n    else {\n      const response = await fetch(`${SettingApp}/SearchBusStop?searchText=${this.state.searchTxt}`)\n      const busLine = await response.json()\n      // console.log(\"busLineSearch :::: \", busLine[0])\n      let busLine2 = busLine[0]\n      let BuslineTemp = []\n      busLine2.map((e, key) => {\n        BuslineTemp.push({ data : e, show : false})\n      })\n      await this.setState({ busLine : BuslineTemp })\n    }\n  }\n\n  getLocation = async () => {\n    navigator.geolocation.getCurrentPosition(\n      position => {\n        let latlng = {\n          latitude: parseFloat(JSON.stringify(position.coords.latitude)),\n          longitude: parseFloat(JSON.stringify(position.coords.longitude))\n        }\n        let region ={\n          latitude: parseFloat(JSON.stringify(position.coords.latitude)),\n          longitude: parseFloat(JSON.stringify(position.coords.longitude)),\n          latitudeDelta: 0.015,\n          longitudeDelta: 0.0121\n        }\n        this.setState({ latlng , region  })\n        // console.log(\"re :::: \",this.state.region)\n      },\n      error => alert(error.message),\n      { enableHighAccuracy: true, timeout: 20000, maximumAge: 1000 }\n    )\n    this.watchID = await navigator.geolocation.watchPosition(position => {\n      let latlng = {\n        latitude: parseFloat(JSON.stringify(position.coords.latitude)),\n        longitude: parseFloat(JSON.stringify(position.coords.longitude))\n      }\n      let region ={\n        latitude: parseFloat(JSON.stringify(position.coords.latitude)),\n        longitude: parseFloat(JSON.stringify(position.coords.longitude)),\n        latitudeDelta: 0.015,\n        longitudeDelta: 0.0121\n      }\n      this.setState({ latlng , region })\n      // console.log(\"re :::: \",this.state.region)\n    })\n  }\n\n  fetchbusActiveData = async () => {\n    let {searchTxt, busLine} = this.state\n    let lineQuery = []\n    if(searchTxt == \"\"){ \n    const response = await fetch(`${SettingApp}/getVehicleActive?Vehicle_Type='Van'`)\n    const BusActive = await response.json()\n    // console.log(\"BusActive :::: \", BusActive)\n    await this.setState({ BusActive})\n    }else { \n      busLine.map(item => {\n        lineQuery.push(item.data.busline_code)\n      })\n      const response = await fetch(`${SettingApp}/getVehicleActiveQuery?Vehicle_Type='Van'&lineQuery=${lineQuery}`)\n      const BusActive = await response.json()\n      await this.setState({ BusActive})\n    }\n  }\n\n  \n  componentWillUnmount = () => {\n    clearInterval(this.intervalID);\n    navigator.geolocation.clearWatch(this.watchID)\n  }\n\n  onOutFocus = async () => {\n    Keyboard.dismiss()\n    await this.setState({ typing: false, searchTxt : '' })\n    await this.fetchData()\n    await this.fetchbusLineData()\n    await this.fetchbusActiveData()\n\n  }\n\n  onSearchSubmit = async () => {\n    await this.setState({ typing: false })\n    await this.fetchData()\n    await this.fetchbusLineData()\n    await this.fetchbusActiveData()\n\n  }\n\n\n\n  openDetail = (id) => {\n    let { busLine } = this.state;\n    const tempIndex = busLine.findIndex( e => {\n        return e.data.busline_code == id\n    });\n    busLine[tempIndex].show = !busLine[tempIndex].show;\n    this.setState({busLine});\n}\n\n  onRegionChangeComplete = async(region) => {\n    console.log('onRegionChangeComplete ::: ', region);\n    try {\n      await AsyncStorage.setItem('@region', JSON.stringify(region));\n    } catch (error) {\n      console.log(error)\n    }\n  };\n\n  openMenuFunc = async() => {\n    try {\n      const value = await AsyncStorage.getItem(\"@region\");\n      if (value !== null) {\n        await this.setState({ region: JSON.parse(value) });\n      }\n    } catch (error) {\n      console.log(error);\n    }\n    this.setState({ openMenu: !this.state.openMenu })\n  }\n\n\n\n  render() {\n    let {region, latlng} = this.state\n    return (\n      <View style={styles.container}>\n        <StatusBar barStyle=\"dark-content\" />\n        <MapView\n          provider={PROVIDER_GOOGLE} // remove if not using Google Maps\n          style={styles.map}\n          onRegionChange={this.onRegionChangeComplete}\n          region={this.state.region}\n        >\n         \n          {this.state.busStop.map((marker, key) => {\n            let LatLng = {\n              latitude: parseFloat(marker.latitude),\n              longitude: parseFloat(marker.longitude)\n            }\n            return (\n              <Marker\n                key={key}\n                coordinate={LatLng}\n                title={marker.busstop_name}\n                description={marker.description}\n              >\n                <BusStopIcon textLine={marker.busline_name} />\n              </Marker>\n            )\n          })}\n          {this.state.BusActive.map((marker, key) => {\n            let LatLng = {\n              latitude: parseFloat(marker.lat) || 10000,\n              longitude: parseFloat(marker.lon) || 10000\n            }\n            return (\n              <Marker\n                key={key}\n                coordinate={LatLng}\n                title={marker.busstop_name}\n                description={marker.Vehicle_Name}\n              >\n                <VanActive textLine={marker.busline_code}  />\n              </Marker>\n            )\n          })}\n           <Marker\n            coordinate={this.state.latlng}\n            title={this.state.markers.title}\n            description={this.state.markers.description}\n          >\n            <View>\n              <Image\n                source={require(\"../assets/icon/self-map-marker.png\")}\n                style={{ width: 70, height: 70, zIndex : 100 }}\n              />\n              {/* <Text>คุณอยู่ที่นี่</Text> */}\n            </View>\n          </Marker>\n        </MapView>\n\n        <MenuSlide\n          openMenu={this.state.openMenu}\n        >\n         <TouchableOpacity style={{width : Dimensions.get(\"window\").width}} onPress={() => this.setState({ openMenu: !this.state.openMenu })}>\n            <TextMenuSlide openMenu={this.state.openMenu}>Van</TextMenuSlide>\n         </TouchableOpacity>\n          <TouchableOpacity style={styles.Line} onPress={() => this.setState({ openMenu: !this.state.openMenu })}/>\n          <ScrollView >\n            {this.state.busLine.map((item, key) => (\n              // <View key={key}></View>\n              <BusStopDetail key={key} data={item.data} show={item.show} openDetail={this.openDetail} />\n            ))}\n          </ScrollView>\n        </MenuSlide>\n\n{/* //////////////////////////////////////////////////////////////// */}\n\n        <SearchTab typing={this.state.typing}>\n          <Image\n            source={require(\"../assets/icon/search.png\")}\n            style={{ width: 30, height: 30}}\n            onPress={() => this.setState({ typing: false })}\n          />\n\n          {/* <KeyboardAwareScrollView styles={{}}> */}\n          <TextInput\n            placeholder=\"Where to ?\"\n            style={styles.InputStyle}\n            onChangeText={searchTxt => this.setState({ searchTxt })}\n            value={this.state.searchTxt}\n            blurOnSubmit={true}\n            onFocus={() => this.setState({ typing: true })}\n            onSubmitEditing={() => this.onSearchSubmit()}\n          />\n          {/* </KeyboardAwareScrollView> */}\n\n          {this.state.typing && (\n            <TouchableOpacity onPress={() => this.onOutFocus()}>\n              <Image\n                source={require(\"../assets/icon/close.png\")}\n                style={{ width: 20, height: 20 }}\n              />\n            </TouchableOpacity>\n          )}\n        </SearchTab>\n\n        {/* ///////////////////////////////////////////////////// */}\n      </View>\n    )\n  }\n}\n\nlet width = Dimensions.get(\"window\").width\nlet height = Dimensions.get(\"window\").height\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 3,\n    justifyContent: \"flex-end\",\n    alignItems: \"center\"\n  },\n  map: {\n    ...StyleSheet.absoluteFillObject\n  },\n  Line: {\n    width: 90,\n    height: 6,\n    backgroundColor: \"rgb(71, 69, 245)\",\n    top: 0,\n    position: \"absolute\",\n    borderRadius: 50,\n    marginTop: 10\n  },\n  ViewFlex: {\n    width : width-70,\n    flexDirection: \"row\",\n    paddingTop : 20,\n    paddingBottom : 20,\n    marginStart :30,\n    marginEnd : 30,\n    justifyContent: \"flex-start\",\n    alignItems: \"center\",\n    borderBottomWidth : 1,\n    borderBottomColor : 'rgba(255,255,255,0.5)',\n  },\n  LineFlex: {\n   marginTop : 20,\n    width: 300,\n    height: 0.5,\n    backgroundColor: \"rgba(255,255,255,0.5)\",\n    borderRadius: 50,\n  },\n  InputStyle: {\n    marginTop: 20,\n    paddingBottom: 20,\n    fontSize: 30,\n    width: 250,\n    textAlign: \"center\",\n    color: \"rgb(29, 25, 204)\"\n  }\n})\n\nconst MenuSlide = styled(View)`\n  width: ${width};\n  height: ${props => props.openMenu ? 500 : 150};\n  position:absolute;\n  top:${props => props.openMenu ? 250 : height-250};   \n  backgroundColor: 'rgb(29,25,204)';\n  borderRadius: 60;\n  borderBottomEndRadius :  0;\n  borderBottomStartRadius :  0;\n  borderWidth: 0;\n  justifyContent: flex-start;\n  alignItems: center;\n  paddingTop : 15;\n  paddingBottom : 50;\n`;\n\nconst SearchTab = styled(View)`\n  width: ${width};\n  height: 90;\n  backgroundColor: white;\n  borderRadius: 60;\n  borderBottomEndRadius :  0;\n  borderBottomStartRadius :  0;\n  borderWidth: 0;\n  justifyContent: center;\n  alignItems: center;\n  marginTop : ${height-180};\n  marginBottom : ${props => props.typing ? 300 : 0}\n  flexDirection: row;\n`;\n\nconst TextMenuSlide = styled(Text)`\n  fontSize: 30;\n  color: 'rgb(101,102,251)';\n  textAlign: center;\n  paddingLeft: 10;\n  paddingRight: 10;\n  marginTop: 10;\n`"]},"metadata":{},"sourceType":"module"}